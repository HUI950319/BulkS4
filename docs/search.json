[{"path":"https://hui950319.github.io/BulkS4/articles/differential-analysis.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Differential Expression Analysis with BulkS4","text":"tutorial demonstrates perform differential expression analysis using BulkS4. package supports three popular methods: DESeq2: Negative binomial distribution-based method edgeR: Empirical Bayes method overdispersed count data limma-voom: Linear modeling precision weights","code":""},{"path":"https://hui950319.github.io/BulkS4/articles/differential-analysis.html","id":"setup","dir":"Articles","previous_headings":"","what":"Setup","title":"Differential Expression Analysis with BulkS4","text":"","code":"library(BulkS4)  # Load example data data(counts) data(metadata)  # Create BulkRNAseq object bulk_obj <- BulkRNAseq(counts, metadata)"},{"path":[]},{"path":"https://hui950319.github.io/BulkS4/articles/differential-analysis.html","id":"using-deseq2","dir":"Articles","previous_headings":"Single Method Analysis","what":"Using DESeq2","title":"Differential Expression Analysis with BulkS4","text":"","code":"# Run DESeq2 analysis if (requireNamespace(\"DESeq2\", quietly = TRUE)) {   deseq2_results <- run_DESeq2(     counts = getCounts(bulk_obj),     metadata = getMetadata(bulk_obj),     group_col = \"condition\",     control_group = \"Control\",     treatment_group = \"Treatment\"   )      head(deseq2_results) }"},{"path":"https://hui950319.github.io/BulkS4/articles/differential-analysis.html","id":"using-edger","dir":"Articles","previous_headings":"Single Method Analysis","what":"Using edgeR","title":"Differential Expression Analysis with BulkS4","text":"","code":"# Run edgeR analysis if (requireNamespace(\"edgeR\", quietly = TRUE)) {   edger_results <- run_edgeR(     counts = getCounts(bulk_obj),     metadata = getMetadata(bulk_obj),     group_col = \"condition\",     control_group = \"Control\",     treatment_group = \"Treatment\"   )      head(edger_results) }"},{"path":"https://hui950319.github.io/BulkS4/articles/differential-analysis.html","id":"using-limma-voom","dir":"Articles","previous_headings":"Single Method Analysis","what":"Using limma-voom","title":"Differential Expression Analysis with BulkS4","text":"","code":"# Run limma-voom analysis if (requireNamespace(\"limma\", quietly = TRUE)) {   limma_results <- run_limma_voom(     counts = getCounts(bulk_obj),     metadata = getMetadata(bulk_obj),     group_col = \"condition\",     control_group = \"Control\",     treatment_group = \"Treatment\"   )      head(limma_results) }"},{"path":[]},{"path":"https://hui950319.github.io/BulkS4/articles/differential-analysis.html","id":"running-multiple-methods","dir":"Articles","previous_headings":"Integrated Analysis","what":"Running Multiple Methods","title":"Differential Expression Analysis with BulkS4","text":"runDiffAnalysis() function allows run multiple methods :","code":"# Run all three methods bulk_obj <- runDiffAnalysis(   bulk_obj,   group_col = \"condition\",   control_group = \"Control\",   treatment_group = \"Treatment\",   methods = c(\"DESeq2\", \"edgeR\", \"limma\") )  # View analysis summary summary(bulk_obj)"},{"path":"https://hui950319.github.io/BulkS4/articles/differential-analysis.html","id":"comparing-methods","dir":"Articles","previous_headings":"Integrated Analysis","what":"Comparing Methods","title":"Differential Expression Analysis with BulkS4","text":"","code":"# Compare results from different methods comparison <- compareDiffMethods(bulk_obj) print(comparison)"},{"path":"https://hui950319.github.io/BulkS4/articles/differential-analysis.html","id":"extracting-results","dir":"Articles","previous_headings":"Integrated Analysis","what":"Extracting Results","title":"Differential Expression Analysis with BulkS4","text":"","code":"# Extract results from specific method deseq2_results <- extractDiffResults(bulk_obj, method = \"DESeq2\") edger_results <- extractDiffResults(bulk_obj, method = \"edgeR\")  # Get analysis summary analysis_summary <- getAnalysisSummary(bulk_obj) print(analysis_summary)"},{"path":[]},{"path":"https://hui950319.github.io/BulkS4/articles/differential-analysis.html","id":"filtering-significant-genes","dir":"Articles","previous_headings":"Filtering and Visualization","what":"Filtering Significant Genes","title":"Differential Expression Analysis with BulkS4","text":"","code":"# Filter significant genes (example with DESeq2 results) if (exists(\"deseq2_results\")) {   significant_genes <- deseq2_results[     deseq2_results$padj < 0.05 & abs(deseq2_results$log2FoldChange) > 1,   ]      cat(\"Number of significant genes:\", nrow(significant_genes), \"\\n\")   head(significant_genes) }"},{"path":"https://hui950319.github.io/BulkS4/articles/differential-analysis.html","id":"basic-visualization","dir":"Articles","previous_headings":"Filtering and Visualization","what":"Basic Visualization","title":"Differential Expression Analysis with BulkS4","text":"","code":"# MA plot (example) if (exists(\"deseq2_results\")) {   plot(deseq2_results$baseMean, deseq2_results$log2FoldChange,        log = \"x\", pch = 20, cex = 0.5,        xlab = \"Mean Expression\", ylab = \"Log2 Fold Change\",        main = \"MA Plot\")   abline(h = c(-1, 1), col = \"red\", lty = 2) }"},{"path":[]},{"path":"https://hui950319.github.io/BulkS4/articles/differential-analysis.html","id":"custom-contrasts","dir":"Articles","previous_headings":"Advanced Usage","what":"Custom Contrasts","title":"Differential Expression Analysis with BulkS4","text":"","code":"# For more complex experimental designs # You can specify custom contrasts in the metadata  # Example: Time course experiment metadata_timecourse <- data.frame(   condition = rep(c(\"Control\", \"Treatment\"), each = 6),   timepoint = rep(c(\"0h\", \"6h\", \"12h\"), times = 4),   row.names = colnames(counts) )  bulk_obj_time <- BulkRNAseq(counts, metadata_timecourse)  # Run analysis for specific contrast bulk_obj_time <- runDiffAnalysis(   bulk_obj_time,   group_col = \"condition\",   methods = \"DESeq2\" )"},{"path":"https://hui950319.github.io/BulkS4/articles/differential-analysis.html","id":"batch-effect-correction","dir":"Articles","previous_headings":"Advanced Usage","what":"Batch Effect Correction","title":"Differential Expression Analysis with BulkS4","text":"","code":"# If you have batch information in metadata if (\"batch\" %in% colnames(getMetadata(bulk_obj))) {   # The analysis functions automatically include batch as a covariate   # when it's present in the metadata      bulk_obj_batch <- runDiffAnalysis(     bulk_obj,     group_col = \"condition\",     methods = \"DESeq2\"   ) }"},{"path":"https://hui950319.github.io/BulkS4/articles/differential-analysis.html","id":"best-practices","dir":"Articles","previous_headings":"","what":"Best Practices","title":"Differential Expression Analysis with BulkS4","text":"Quality Control: Always perform quality control data analysis Multiple Methods: Consider using multiple methods comparing results Multiple Testing: Use appropriate multiple testing correction (FDR) Effect Size: Consider statistical significance biological significance Validation: Validate important findings independent methods","code":""},{"path":[]},{"path":"https://hui950319.github.io/BulkS4/articles/differential-analysis.html","id":"common-issues","dir":"Articles","previous_headings":"Troubleshooting","what":"Common Issues","title":"Differential Expression Analysis with BulkS4","text":"Missing Packages: Install required Bioconductor packages: Low Count Filtering: functions automatically filter low-count genes Sample Size: Ensure adequate sample size reliable results","code":"if (!requireNamespace(\"BiocManager\", quietly = TRUE))   install.packages(\"BiocManager\")  BiocManager::install(c(\"DESeq2\", \"edgeR\", \"limma\"))"},{"path":"https://hui950319.github.io/BulkS4/articles/differential-analysis.html","id":"session-information","dir":"Articles","previous_headings":"","what":"Session Information","title":"Differential Expression Analysis with BulkS4","text":"","code":"sessionInfo() #> R version 4.4.3 (2025-02-28 ucrt) #> Platform: x86_64-w64-mingw32/x64 #> Running under: Windows 11 x64 (build 22631) #>  #> Matrix products: default #>  #>  #> locale: #> [1] LC_COLLATE=Chinese (Simplified)_China.utf8  #> [2] LC_CTYPE=Chinese (Simplified)_China.utf8    #> [3] LC_MONETARY=Chinese (Simplified)_China.utf8 #> [4] LC_NUMERIC=C                                #> [5] LC_TIME=Chinese (Simplified)_China.utf8     #>  #> time zone: Asia/Shanghai #> tzcode source: internal #>  #> attached base packages: #> [1] stats     graphics  grDevices utils     datasets  methods   base      #>  #> other attached packages: #> [1] BulkS4_0.1.1 #>  #> loaded via a namespace (and not attached): #>   [1] RColorBrewer_1.1-3          rstudioapi_0.17.1           #>   [3] jsonlite_2.0.0              magrittr_2.0.3              #>   [5] ggtangle_0.0.6              magick_2.8.6                #>   [7] farver_2.1.2                rmarkdown_2.29              #>   [9] fs_1.6.6                    zlibbioc_1.52.0             #>  [11] ragg_1.4.0                  vctrs_0.6.5                 #>  [13] memoise_2.0.1               ggtree_3.14.0               #>  [15] htmltools_0.5.8.1           S4Arrays_1.6.0              #>  [17] Rhdf5lib_1.28.0             SparseArray_1.6.2           #>  [19] rhdf5_2.50.2                gridGraphics_0.5-1          #>  [21] sass_0.4.10                 bslib_0.9.0                 #>  [23] htmlwidgets_1.6.4           desc_1.4.3                  #>  [25] plyr_1.8.9                  cachem_1.1.0                #>  [27] igraph_2.0.3                lifecycle_1.0.4             #>  [29] pkgconfig_2.0.3             gson_0.1.0                  #>  [31] rsvd_1.0.5                  Matrix_1.7-3                #>  [33] R6_2.6.1                    fastmap_1.2.0               #>  [35] GenomeInfoDbData_1.2.13     MatrixGenerics_1.18.1       #>  [37] digest_0.6.37               aplot_0.2.5                 #>  [39] enrichplot_1.26.6           colorspace_2.1-0            #>  [41] patchwork_1.3.0             AnnotationDbi_1.68.0        #>  [43] S4Vectors_0.44.0            irlba_2.3.5.1               #>  [45] textshaping_1.0.0           GenomicRanges_1.58.0        #>  [47] RSQLite_2.3.9               beachmat_2.22.0             #>  [49] httr_1.4.7                  abind_1.4-8                 #>  [51] compiler_4.4.3              bit64_4.6.0-1               #>  [53] BiocParallel_1.40.2         DBI_1.2.3                   #>  [55] HDF5Array_1.34.0            R.utils_2.13.0              #>  [57] DelayedArray_0.32.0         rjson_0.2.23                #>  [59] tools_4.4.3                 ape_5.8-1                   #>  [61] R.oo_1.27.1                 glue_1.8.0                  #>  [63] nlme_3.1-168                GOSemSim_2.32.0             #>  [65] rhdf5filters_1.18.1         grid_4.4.3                  #>  [67] reshape2_1.4.4              fgsea_1.32.4                #>  [69] generics_0.1.3              gtable_0.3.6                #>  [71] R.methodsS3_1.8.2           tidyr_1.3.0                 #>  [73] data.table_1.15.4           BiocSingular_1.22.0         #>  [75] ScaledMatrix_1.14.0         XVector_0.46.0              #>  [77] BiocGenerics_0.52.0         ggrepel_0.9.6               #>  [79] pillar_1.10.2               stringr_1.5.1               #>  [81] limma_3.62.2                yulab.utils_0.2.0           #>  [83] GSVA_2.0.7                  splines_4.4.3               #>  [85] dplyr_1.1.4                 treeio_1.30.0               #>  [87] lattice_0.22-7              bit_4.6.0                   #>  [89] annotate_1.84.0             tidyselect_1.2.1            #>  [91] GO.db_3.20.0                SingleCellExperiment_1.28.1 #>  [93] Biostrings_2.74.1           knitr_1.50                  #>  [95] IRanges_2.40.1              SummarizedExperiment_1.36.0 #>  [97] stats4_4.4.3                xfun_0.52                   #>  [99] Biobase_2.66.0              statmod_1.5.0               #> [101] matrixStats_1.5.0           stringi_1.8.7               #> [103] UCSC.utils_1.2.0            lazyeval_0.2.2              #> [105] ggfun_0.1.8                 yaml_2.3.10                 #> [107] evaluate_1.0.3              codetools_0.2-20            #> [109] tibble_3.2.1                qvalue_2.38.0               #> [111] graph_1.84.1                ggplotify_0.1.2             #> [113] cli_3.6.4                   xtable_1.8-4                #> [115] systemfonts_1.2.2           munsell_0.5.1               #> [117] jquerylib_0.1.4             Rcpp_1.0.14                 #> [119] GenomeInfoDb_1.42.3         png_0.1-8                   #> [121] XML_3.99-0.18               parallel_4.4.3              #> [123] pkgdown_2.1.1               ggplot2_3.5.2               #> [125] blob_1.2.4                  clusterProfiler_4.14.6      #> [127] DOSE_4.0.1                  sparseMatrixStats_1.18.0    #> [129] SpatialExperiment_1.16.0    tidytree_0.4.6              #> [131] GSEABase_1.68.0             scales_1.3.0                #> [133] purrr_1.0.2                 crayon_1.5.3                #> [135] rlang_1.1.6                 cowplot_1.1.3               #> [137] fastmatch_1.1-6             KEGGREST_1.46.0"},{"path":"https://hui950319.github.io/BulkS4/articles/getting-started.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Getting Started with BulkS4","text":"BulkS4 comprehensive R package designed bulk RNA-seq data analysis using S4 classes. package provides unified framework storing, analyzing, visualizing bulk RNA-seq data, including: Differential expression analysis using DESeq2, edgeR, limma-voom Gene set enrichment analysis (GSEA) Gene set variation analysis (GSVA) Integrated data management S4 classes","code":""},{"path":"https://hui950319.github.io/BulkS4/articles/getting-started.html","id":"installation","dir":"Articles","previous_headings":"","what":"Installation","title":"Getting Started with BulkS4","text":"","code":"# Install from GitHub devtools::install_github(\"HUI950319/BulkS4\")"},{"path":"https://hui950319.github.io/BulkS4/articles/getting-started.html","id":"loading-the-package","dir":"Articles","previous_headings":"","what":"Loading the Package","title":"Getting Started with BulkS4","text":"","code":"library(BulkS4) #>  #> Warning: multiple methods tables found for 'gsva'"},{"path":[]},{"path":"https://hui950319.github.io/BulkS4/articles/getting-started.html","id":"loading-example-data","dir":"Articles","previous_headings":"Quick Start","what":"Loading Example Data","title":"Getting Started with BulkS4","text":"BulkS4 comes example datasets can use get started:","code":"# Load example datasets data(counts)      # RNA-seq count matrix data(metadata)    # Sample metadata data(geneSet_msig) # MSigDB gene sets  # Examine the data head(counts[, 1:6]) #>          Cov1 Cov2 Cov3 Mock1 Mock2 Mock3 #> TSPAN6   1270 1013  848  4571  5500  4844 #> TNMD      121  125   49  3220  6435  2977 #> DPM1     1023 1045  674  2404  4794  1819 #> SCYL3    1049  713  692   854   356  1015 #> C1orf112  211  158   90   576   195   477 #> FGR         9    8    2    10     5     0 head(metadata) #>       sample group #> Cov1    Cov1 treat #> Cov2    Cov2 treat #> Cov3    Cov3 treat #> Mock1  Mock1   con #> Mock2  Mock2   con #> Mock3  Mock3   con"},{"path":"https://hui950319.github.io/BulkS4/articles/getting-started.html","id":"creating-a-bulkrnaseq-object","dir":"Articles","previous_headings":"Quick Start","what":"Creating a BulkRNAseq Object","title":"Getting Started with BulkS4","text":"core BulkS4 BulkRNAseq S4 class, stores RNA-seq data analysis results:","code":"# Create BulkRNAseq object bulk_obj <- BulkRNAseq(counts, metadata) #> Successfully loaded MSigDB gene sets from package data  # View the object bulk_obj #>  #>  ====== BulkRNAseq Object ======  #>  #> Genes:          36888 #> Samples:        6 #> Metadata vars:  sample, group #>  #>  ------ Analysis Results ------  #>  #> Diff analyses:  0: None #> Gene sets:      25: C1, C2_CGP, C2_CP, C2_CP:BIOCARTA, C2_CP:KEGG_LEGACY, C2_CP:KEGG_MEDICUS, C2_CP:PID, C2_CP:REACTOME, C2_CP:WIKIPATHWAYS, C3_MIR:MIRDB, C3_MIR:MIR_LEGACY, C3_TFT:GTRD, C3_TFT:TFT_LEGACY, C4_3CA, C4_CGN, C4_CM, C5_GO:BP, C5_GO:CC, C5_GO:MF, C5_HPO, C6, C7_IMMUNESIGDB, C7_VAX, C8, H #> GSEA results:   0: None #> GSVA results:   0: None #>  #>  --------------------------------------------------"},{"path":"https://hui950319.github.io/BulkS4/articles/getting-started.html","id":"basic-operations","dir":"Articles","previous_headings":"Quick Start","what":"Basic Operations","title":"Getting Started with BulkS4","text":"","code":"# Get dimensions dim(bulk_obj) #> [1] 36888     6  # Get gene and sample names head(rownames(bulk_obj)) #> [1] \"TSPAN6\"   \"TNMD\"     \"DPM1\"     \"SCYL3\"    \"C1orf112\" \"FGR\" colnames(bulk_obj) #> [1] \"Cov1\"  \"Cov2\"  \"Cov3\"  \"Mock1\" \"Mock2\" \"Mock3\"  # Access metadata columns head(bulk_obj$group) #> [1] treat treat treat con   con   con   #> Levels: con treat"},{"path":"https://hui950319.github.io/BulkS4/articles/getting-started.html","id":"data-access","dir":"Articles","previous_headings":"Quick Start","what":"Data Access","title":"Getting Started with BulkS4","text":"","code":"# Get raw counts raw_counts <- getCounts(bulk_obj) dim(raw_counts) #> [1] 36888     6  # Get normalized data (initially same as counts) norm_data <- getData(bulk_obj)  # Get metadata sample_meta <- getMetadata(bulk_obj) str(sample_meta) #> 'data.frame':    6 obs. of  2 variables: #>  $ sample: chr  \"Cov1\" \"Cov2\" \"Cov3\" \"Mock1\" ... #>  $ group : Factor w/ 2 levels \"con\",\"treat\": 2 2 2 1 1 1"},{"path":"https://hui950319.github.io/BulkS4/articles/getting-started.html","id":"data-manipulation","dir":"Articles","previous_headings":"Quick Start","what":"Data Manipulation","title":"Getting Started with BulkS4","text":"","code":"# Set normalized data (log2 transformation) log_counts <- log2(getCounts(bulk_obj) + 1) bulk_obj <- setData(bulk_obj, log_counts)  # Verify the change head(getData(bulk_obj)[, 1:3]) #>               Cov1      Cov2     Cov3 #> TSPAN6   10.311748  9.985842 9.729621 #> TNMD      6.930737  6.977280 5.643856 #> DPM1     10.000000 10.030667 9.398744 #> SCYL3    10.036174  9.479780 9.436712 #> C1orf112  7.727920  7.312883 6.507795 #> FGR       3.321928  3.169925 1.584963"},{"path":"https://hui950319.github.io/BulkS4/articles/getting-started.html","id":"subsetting","dir":"Articles","previous_headings":"Quick Start","what":"Subsetting","title":"Getting Started with BulkS4","text":"","code":"# Subset to first 100 genes and first 6 samples subset_obj <- bulk_obj[1:100, 1:6] dim(subset_obj) #> [1] 100   6"},{"path":"https://hui950319.github.io/BulkS4/articles/getting-started.html","id":"next-steps","dir":"Articles","previous_headings":"","what":"Next Steps","title":"Getting Started with BulkS4","text":"Now ’ve learned basics, can explore advanced features: Differential Expression Analysis: See “Differential Expression Analysis” tutorial Gene Set Analysis: See “Gene Set Analysis” tutorial Advanced Usage: See “Basic Usage” tutorial detailed examples","code":""},{"path":"https://hui950319.github.io/BulkS4/articles/getting-started.html","id":"session-information","dir":"Articles","previous_headings":"","what":"Session Information","title":"Getting Started with BulkS4","text":"","code":"sessionInfo() #> R version 4.4.3 (2025-02-28 ucrt) #> Platform: x86_64-w64-mingw32/x64 #> Running under: Windows 11 x64 (build 22631) #>  #> Matrix products: default #>  #>  #> locale: #> [1] LC_COLLATE=Chinese (Simplified)_China.utf8  #> [2] LC_CTYPE=Chinese (Simplified)_China.utf8    #> [3] LC_MONETARY=Chinese (Simplified)_China.utf8 #> [4] LC_NUMERIC=C                                #> [5] LC_TIME=Chinese (Simplified)_China.utf8     #>  #> time zone: Asia/Shanghai #> tzcode source: internal #>  #> attached base packages: #> [1] stats     graphics  grDevices utils     datasets  methods   base      #>  #> other attached packages: #> [1] BulkS4_0.1.1 #>  #> loaded via a namespace (and not attached): #>   [1] RColorBrewer_1.1-3          rstudioapi_0.17.1           #>   [3] jsonlite_2.0.0              magrittr_2.0.3              #>   [5] ggtangle_0.0.6              magick_2.8.6                #>   [7] farver_2.1.2                rmarkdown_2.29              #>   [9] fs_1.6.6                    zlibbioc_1.52.0             #>  [11] ragg_1.4.0                  vctrs_0.6.5                 #>  [13] memoise_2.0.1               ggtree_3.14.0               #>  [15] htmltools_0.5.8.1           S4Arrays_1.6.0              #>  [17] Rhdf5lib_1.28.0             SparseArray_1.6.2           #>  [19] rhdf5_2.50.2                gridGraphics_0.5-1          #>  [21] sass_0.4.10                 bslib_0.9.0                 #>  [23] htmlwidgets_1.6.4           desc_1.4.3                  #>  [25] plyr_1.8.9                  cachem_1.1.0                #>  [27] igraph_2.0.3                lifecycle_1.0.4             #>  [29] pkgconfig_2.0.3             gson_0.1.0                  #>  [31] rsvd_1.0.5                  Matrix_1.7-3                #>  [33] R6_2.6.1                    fastmap_1.2.0               #>  [35] GenomeInfoDbData_1.2.13     MatrixGenerics_1.18.1       #>  [37] digest_0.6.37               aplot_0.2.5                 #>  [39] enrichplot_1.26.6           colorspace_2.1-0            #>  [41] patchwork_1.3.0             AnnotationDbi_1.68.0        #>  [43] S4Vectors_0.44.0            irlba_2.3.5.1               #>  [45] textshaping_1.0.0           GenomicRanges_1.58.0        #>  [47] RSQLite_2.3.9               beachmat_2.22.0             #>  [49] httr_1.4.7                  abind_1.4-8                 #>  [51] compiler_4.4.3              bit64_4.6.0-1               #>  [53] BiocParallel_1.40.2         DBI_1.2.3                   #>  [55] HDF5Array_1.34.0            R.utils_2.13.0              #>  [57] DelayedArray_0.32.0         rjson_0.2.23                #>  [59] tools_4.4.3                 ape_5.8-1                   #>  [61] R.oo_1.27.1                 glue_1.8.0                  #>  [63] nlme_3.1-168                GOSemSim_2.32.0             #>  [65] rhdf5filters_1.18.1         grid_4.4.3                  #>  [67] reshape2_1.4.4              fgsea_1.32.4                #>  [69] generics_0.1.3              gtable_0.3.6                #>  [71] R.methodsS3_1.8.2           tidyr_1.3.0                 #>  [73] data.table_1.15.4           BiocSingular_1.22.0         #>  [75] ScaledMatrix_1.14.0         XVector_0.46.0              #>  [77] BiocGenerics_0.52.0         ggrepel_0.9.6               #>  [79] pillar_1.10.2               stringr_1.5.1               #>  [81] limma_3.62.2                yulab.utils_0.2.0           #>  [83] GSVA_2.0.7                  splines_4.4.3               #>  [85] dplyr_1.1.4                 treeio_1.30.0               #>  [87] lattice_0.22-7              bit_4.6.0                   #>  [89] annotate_1.84.0             tidyselect_1.2.1            #>  [91] GO.db_3.20.0                SingleCellExperiment_1.28.1 #>  [93] Biostrings_2.74.1           knitr_1.50                  #>  [95] IRanges_2.40.1              SummarizedExperiment_1.36.0 #>  [97] stats4_4.4.3                xfun_0.52                   #>  [99] Biobase_2.66.0              statmod_1.5.0               #> [101] matrixStats_1.5.0           stringi_1.8.7               #> [103] UCSC.utils_1.2.0            lazyeval_0.2.2              #> [105] ggfun_0.1.8                 yaml_2.3.10                 #> [107] evaluate_1.0.3              codetools_0.2-20            #> [109] tibble_3.2.1                qvalue_2.38.0               #> [111] graph_1.84.1                ggplotify_0.1.2             #> [113] cli_3.6.4                   xtable_1.8-4                #> [115] systemfonts_1.2.2           munsell_0.5.1               #> [117] jquerylib_0.1.4             Rcpp_1.0.14                 #> [119] GenomeInfoDb_1.42.3         png_0.1-8                   #> [121] XML_3.99-0.18               parallel_4.4.3              #> [123] pkgdown_2.1.1               ggplot2_3.5.2               #> [125] blob_1.2.4                  clusterProfiler_4.14.6      #> [127] DOSE_4.0.1                  sparseMatrixStats_1.18.0    #> [129] SpatialExperiment_1.16.0    tidytree_0.4.6              #> [131] GSEABase_1.68.0             scales_1.3.0                #> [133] purrr_1.0.2                 crayon_1.5.3                #> [135] rlang_1.1.6                 cowplot_1.1.3               #> [137] fastmatch_1.1-6             KEGGREST_1.46.0"},{"path":"https://hui950319.github.io/BulkS4/articles/visualization.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Visualization with BulkS4","text":"BulkS4 provides comprehensive visualization methods RNA-seq data analysis. tutorial demonstrates create various plots : Gene expression visualization (bar plots, box plots) Heatmaps expression patterns Volcano plots differential expression MA plots expression vs fold change PCA hierarchical clustering sample relationships","code":""},{"path":"https://hui950319.github.io/BulkS4/articles/visualization.html","id":"setup","dir":"Articles","previous_headings":"","what":"Setup","title":"Visualization with BulkS4","text":"","code":"library(BulkS4)  # Load example data data(counts) data(metadata)  # Create BulkRNAseq object bulk_obj <- BulkRNAseq(counts, metadata)  # Set normalized data (log2 transformation) log_counts <- log2(getCounts(bulk_obj) + 1) bulk_obj <- setData(bulk_obj, log_counts)"},{"path":[]},{"path":"https://hui950319.github.io/BulkS4/articles/visualization.html","id":"single-gene-visualization","dir":"Articles","previous_headings":"Bar/Box Plots for Gene Expression","what":"Single Gene Visualization","title":"Visualization with BulkS4","text":"","code":"# Basic box plot for a single gene bar(bulk_obj, genes = \"CD36\", group = \"group\")  # Custom colors and statistical test bar(bulk_obj,      genes = \"CD36\",      group = \"group\",     palette = c(\"#E31A1C\", \"#1F78B4\"),     method = \"wilcox.test\")"},{"path":"https://hui950319.github.io/BulkS4/articles/visualization.html","id":"multiple-genes-visualization","dir":"Articles","previous_headings":"Bar/Box Plots for Gene Expression","what":"Multiple Genes Visualization","title":"Visualization with BulkS4","text":"","code":"# Multiple genes in faceted plot selected_genes <- rownames(bulk_obj)[1:6] bar(bulk_obj,      genes = selected_genes,      group = \"condition\",     palette = c(\"#FF7F00\", \"#33A02C\"))"},{"path":"https://hui950319.github.io/BulkS4/articles/visualization.html","id":"gsva-results-visualization","dir":"Articles","previous_headings":"Bar/Box Plots for Gene Expression","what":"GSVA Results Visualization","title":"Visualization with BulkS4","text":"","code":"# First run GSVA analysis bulk_obj <- gsva(bulk_obj, gene_sets = \"hallmark\")  # Visualize pathway scores pathway_names <- rownames(bulk_obj@gsva$hallmark)[1:4] bar(bulk_obj,      data = \"hallmark\",      genes = pathway_names,      group = \"condition\")"},{"path":[]},{"path":"https://hui950319.github.io/BulkS4/articles/visualization.html","id":"gene-expression-heatmaps","dir":"Articles","previous_headings":"Heatmaps","what":"Gene Expression Heatmaps","title":"Visualization with BulkS4","text":"","code":"# Heatmap of specific genes selected_genes <- rownames(bulk_obj)[1:20] hmap(bulk_obj,       genes = selected_genes,      group = \"condition\",      show_rownames = TRUE,      scale = \"row\")  # Custom color palette library(viridis) hmap(bulk_obj,       genes = selected_genes,      group = \"condition\",      color_palette = viridis(50, option = \"plasma\"))"},{"path":"https://hui950319.github.io/BulkS4/articles/visualization.html","id":"top-differential-genes-heatmap","dir":"Articles","previous_headings":"Heatmaps","what":"Top Differential Genes Heatmap","title":"Visualization with BulkS4","text":"","code":"# First run differential analysis bulk_obj <- runDiffAnalysis(bulk_obj,                             group_col = \"condition\",                            methods = \"limma\")  # Heatmap of top 20 differential genes hmap(bulk_obj,       genes = 20,  # Top 20 differential genes      group = \"condition\",      show_rownames = FALSE,      scale = \"row\")"},{"path":"https://hui950319.github.io/BulkS4/articles/visualization.html","id":"pathway-heatmaps","dir":"Articles","previous_headings":"Heatmaps","what":"Pathway Heatmaps","title":"Visualization with BulkS4","text":"","code":"# Heatmap of pathway scores hmap(bulk_obj,       data = \"hallmark\",      genes = 15,  # Top 15 differential pathways      group = \"condition\",      scale = \"row\")"},{"path":[]},{"path":"https://hui950319.github.io/BulkS4/articles/visualization.html","id":"basic-volcano-plot","dir":"Articles","previous_headings":"Volcano Plots","what":"Basic Volcano Plot","title":"Visualization with BulkS4","text":"","code":"# Standard volcano plot volcano(bulk_obj, data = \"allDiff\")  # Custom thresholds and colors volcano(bulk_obj,          data = \"allDiff\",         fc_threshold = 1.5,         adj.P_value_threshold = 0.01,         highlight_fc_threshold = 2,         colors = c(\"red\", \"grey\", \"blue\", \"orange\"),         symmetry = TRUE)"},{"path":"https://hui950319.github.io/BulkS4/articles/visualization.html","id":"enhanced-volcano-plot","dir":"Articles","previous_headings":"Volcano Plots","what":"Enhanced Volcano Plot","title":"Visualization with BulkS4","text":"","code":"# Volcano plot with custom parameters volcano(bulk_obj,          data = \"allDiff\",         fc_threshold = 1,         highlight_fc_threshold = 2.5,         adj.P_value_threshold = 0.05,         point_size = 1.5,         highlight_size = 4,         symmetry = TRUE)"},{"path":[]},{"path":"https://hui950319.github.io/BulkS4/articles/visualization.html","id":"basic-ma-plot","dir":"Articles","previous_headings":"MA Plots","what":"Basic MA Plot","title":"Visualization with BulkS4","text":"","code":"# Standard MA plot MA(bulk_obj, data = \"allDiff\")  # Custom parameters MA(bulk_obj,     data = \"allDiff\",    fc_threshold = 1.5,    adj.P_value_threshold = 0.01,    highlight_fc_threshold = 3,    colors = c(\"darkred\", \"lightgrey\", \"darkblue\", \"green\"))"},{"path":[]},{"path":"https://hui950319.github.io/BulkS4/articles/visualization.html","id":"combined-pca-and-clustering-plot","dir":"Articles","previous_headings":"PCA and Hierarchical Clustering","what":"Combined PCA and Clustering Plot","title":"Visualization with BulkS4","text":"","code":"# Basic PCA and hierarchical clustering pca_hc(bulk_obj)  # Custom clustering parameters pca_hc(bulk_obj,        dist_method = \"manhattan\",        hclust_method = \"complete\",        k = 3,        add_ellipses = TRUE,        repel = TRUE)"},{"path":"https://hui950319.github.io/BulkS4/articles/visualization.html","id":"customized-clustering","dir":"Articles","previous_headings":"PCA and Hierarchical Clustering","what":"Customized Clustering","title":"Visualization with BulkS4","text":"","code":"# Horizontal dendrogram with custom colors pca_hc(bulk_obj,        dist_method = \"euclidean\",        hclust_method = \"ward.D2\",        k = 2,        horiz = TRUE,        rect = TRUE,        rect_fill = TRUE,        pca_style = \"default\")"},{"path":[]},{"path":"https://hui950319.github.io/BulkS4/articles/visualization.html","id":"color-palettes","dir":"Articles","previous_headings":"Advanced Visualization Tips","what":"1. Color Palettes","title":"Visualization with BulkS4","text":"","code":"# Using different color palettes # For categorical data categorical_colors <- c(\"#E31A1C\", \"#1F78B4\", \"#33A02C\", \"#FF7F00\")  # For heatmaps library(RColorBrewer) heatmap_colors <- colorRampPalette(brewer.pal(9, \"RdYlBu\"))(100)  # Using viridis library(viridis) viridis_colors <- viridis(20, option = \"plasma\")"},{"path":"https://hui950319.github.io/BulkS4/articles/visualization.html","id":"combining-plots","dir":"Articles","previous_headings":"Advanced Visualization Tips","what":"2. Combining Plots","title":"Visualization with BulkS4","text":"","code":"# Using patchwork to combine plots library(patchwork)  p1 <- bar(bulk_obj, genes = \"CD36\", group = \"condition\") p2 <- volcano(bulk_obj, data = \"allDiff\")  # Combine plots p1 | p2  # Side by side p1 / p2  # One above the other"},{"path":"https://hui950319.github.io/BulkS4/articles/visualization.html","id":"saving-high-quality-plots","dir":"Articles","previous_headings":"Advanced Visualization Tips","what":"3. Saving High-Quality Plots","title":"Visualization with BulkS4","text":"","code":"# Save plots with high resolution p <- volcano(bulk_obj, data = \"allDiff\", symmetry = TRUE)  # Save as PDF pdf(\"volcano_plot.pdf\", width = 8, height = 6) print(p) dev.off()  # Save as PNG with high DPI png(\"volcano_plot.png\", width = 8, height = 6, units = \"in\", res = 300) print(p) dev.off()"},{"path":[]},{"path":"https://hui950319.github.io/BulkS4/articles/visualization.html","id":"custom-themes","dir":"Articles","previous_headings":"Customization Examples","what":"Custom Themes","title":"Visualization with BulkS4","text":"","code":"# Create custom theme custom_theme <- theme_minimal() +   theme(     plot.title = element_text(size = 14, face = \"bold\"),     axis.title = element_text(size = 12),     axis.text = element_text(size = 10),     legend.position = \"bottom\"   )  # Apply to plots p <- bar(bulk_obj, genes = \"CD36\", group = \"condition\") p + custom_theme"},{"path":"https://hui950319.github.io/BulkS4/articles/visualization.html","id":"interactive-plots","dir":"Articles","previous_headings":"Customization Examples","what":"Interactive Plots","title":"Visualization with BulkS4","text":"","code":"# Convert to interactive plot using plotly library(plotly)  p <- volcano(bulk_obj, data = \"allDiff\") ggplotly(p)"},{"path":"https://hui950319.github.io/BulkS4/articles/visualization.html","id":"best-practices","dir":"Articles","previous_headings":"","what":"Best Practices","title":"Visualization with BulkS4","text":"Choose Appropriate Colors: Use colorblind-friendly palettes Scale Data Properly: Use appropriate scaling heatmaps Label Clearly: Ensure axes legends properly labeled Save High Quality: Use vector formats (PDF, SVG) possible Consider Audience: Adjust complexity based audience","code":""},{"path":[]},{"path":"https://hui950319.github.io/BulkS4/articles/visualization.html","id":"common-issues","dir":"Articles","previous_headings":"Troubleshooting","what":"Common Issues","title":"Visualization with BulkS4","text":"Missing Packages: Install required visualization packages: Memory Issues: large datasets, consider subsetting genes Plot Appearance: Adjust figure dimensions chunk options","code":"install.packages(c(\"ggpubr\", \"pheatmap\", \"viridis\", \"ggrepel\",                    \"factoextra\", \"ggsci\", \"patchwork\"))"},{"path":"https://hui950319.github.io/BulkS4/articles/visualization.html","id":"session-information","dir":"Articles","previous_headings":"","what":"Session Information","title":"Visualization with BulkS4","text":"","code":"sessionInfo() #> R version 4.4.3 (2025-02-28 ucrt) #> Platform: x86_64-w64-mingw32/x64 #> Running under: Windows 11 x64 (build 22631) #>  #> Matrix products: default #>  #>  #> locale: #> [1] LC_COLLATE=Chinese (Simplified)_China.utf8  #> [2] LC_CTYPE=Chinese (Simplified)_China.utf8    #> [3] LC_MONETARY=Chinese (Simplified)_China.utf8 #> [4] LC_NUMERIC=C                                #> [5] LC_TIME=Chinese (Simplified)_China.utf8     #>  #> time zone: Asia/Shanghai #> tzcode source: internal #>  #> attached base packages: #> [1] stats     graphics  grDevices utils     datasets  methods   base      #>  #> other attached packages: #> [1] BulkS4_0.1.1 #>  #> loaded via a namespace (and not attached): #>   [1] RColorBrewer_1.1-3          rstudioapi_0.17.1           #>   [3] jsonlite_2.0.0              magrittr_2.0.3              #>   [5] ggtangle_0.0.6              magick_2.8.6                #>   [7] farver_2.1.2                rmarkdown_2.29              #>   [9] fs_1.6.6                    zlibbioc_1.52.0             #>  [11] ragg_1.4.0                  vctrs_0.6.5                 #>  [13] memoise_2.0.1               ggtree_3.14.0               #>  [15] htmltools_0.5.8.1           S4Arrays_1.6.0              #>  [17] Rhdf5lib_1.28.0             SparseArray_1.6.2           #>  [19] rhdf5_2.50.2                gridGraphics_0.5-1          #>  [21] sass_0.4.10                 bslib_0.9.0                 #>  [23] htmlwidgets_1.6.4           desc_1.4.3                  #>  [25] plyr_1.8.9                  cachem_1.1.0                #>  [27] igraph_2.0.3                lifecycle_1.0.4             #>  [29] pkgconfig_2.0.3             gson_0.1.0                  #>  [31] rsvd_1.0.5                  Matrix_1.7-3                #>  [33] R6_2.6.1                    fastmap_1.2.0               #>  [35] GenomeInfoDbData_1.2.13     MatrixGenerics_1.18.1       #>  [37] digest_0.6.37               aplot_0.2.5                 #>  [39] enrichplot_1.26.6           colorspace_2.1-0            #>  [41] patchwork_1.3.0             AnnotationDbi_1.68.0        #>  [43] S4Vectors_0.44.0            irlba_2.3.5.1               #>  [45] textshaping_1.0.0           GenomicRanges_1.58.0        #>  [47] RSQLite_2.3.9               beachmat_2.22.0             #>  [49] httr_1.4.7                  abind_1.4-8                 #>  [51] compiler_4.4.3              bit64_4.6.0-1               #>  [53] BiocParallel_1.40.2         DBI_1.2.3                   #>  [55] HDF5Array_1.34.0            R.utils_2.13.0              #>  [57] DelayedArray_0.32.0         rjson_0.2.23                #>  [59] tools_4.4.3                 ape_5.8-1                   #>  [61] R.oo_1.27.1                 glue_1.8.0                  #>  [63] nlme_3.1-168                GOSemSim_2.32.0             #>  [65] rhdf5filters_1.18.1         grid_4.4.3                  #>  [67] reshape2_1.4.4              fgsea_1.32.4                #>  [69] generics_0.1.3              gtable_0.3.6                #>  [71] R.methodsS3_1.8.2           tidyr_1.3.0                 #>  [73] data.table_1.15.4           BiocSingular_1.22.0         #>  [75] ScaledMatrix_1.14.0         XVector_0.46.0              #>  [77] BiocGenerics_0.52.0         ggrepel_0.9.6               #>  [79] pillar_1.10.2               stringr_1.5.1               #>  [81] limma_3.62.2                yulab.utils_0.2.0           #>  [83] GSVA_2.0.7                  splines_4.4.3               #>  [85] dplyr_1.1.4                 treeio_1.30.0               #>  [87] lattice_0.22-7              bit_4.6.0                   #>  [89] annotate_1.84.0             tidyselect_1.2.1            #>  [91] GO.db_3.20.0                SingleCellExperiment_1.28.1 #>  [93] Biostrings_2.74.1           knitr_1.50                  #>  [95] IRanges_2.40.1              SummarizedExperiment_1.36.0 #>  [97] stats4_4.4.3                xfun_0.52                   #>  [99] Biobase_2.66.0              statmod_1.5.0               #> [101] matrixStats_1.5.0           stringi_1.8.7               #> [103] UCSC.utils_1.2.0            lazyeval_0.2.2              #> [105] ggfun_0.1.8                 yaml_2.3.10                 #> [107] evaluate_1.0.3              codetools_0.2-20            #> [109] tibble_3.2.1                qvalue_2.38.0               #> [111] graph_1.84.1                ggplotify_0.1.2             #> [113] cli_3.6.4                   xtable_1.8-4                #> [115] systemfonts_1.2.2           munsell_0.5.1               #> [117] jquerylib_0.1.4             Rcpp_1.0.14                 #> [119] GenomeInfoDb_1.42.3         png_0.1-8                   #> [121] XML_3.99-0.18               parallel_4.4.3              #> [123] pkgdown_2.1.1               ggplot2_3.5.2               #> [125] blob_1.2.4                  clusterProfiler_4.14.6      #> [127] DOSE_4.0.1                  sparseMatrixStats_1.18.0    #> [129] SpatialExperiment_1.16.0    tidytree_0.4.6              #> [131] GSEABase_1.68.0             scales_1.3.0                #> [133] purrr_1.0.2                 crayon_1.5.3                #> [135] rlang_1.1.6                 cowplot_1.1.3               #> [137] fastmatch_1.1-6             KEGGREST_1.46.0"},{"path":"https://hui950319.github.io/BulkS4/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Hui Ouyang. Author, maintainer.","code":""},{"path":"https://hui950319.github.io/BulkS4/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Ouyang H (2025). BulkS4: S4 Classes Methods Bulk RNA-seq Data Analysis. R package version 0.1.1, https://github.com/HUI950319/BulkS4, https://hui950319.github.io/BulkS4/.","code":"@Manual{,   title = {BulkS4: S4 Classes and Methods for Bulk RNA-seq Data Analysis},   author = {Hui Ouyang},   year = {2025},   note = {R package version 0.1.1, https://github.com/HUI950319/BulkS4},   url = {https://hui950319.github.io/BulkS4/}, }"},{"path":[]},{"path":"https://hui950319.github.io/BulkS4/DATA_GENERATION_OPTIMIZATION.html","id":"概述","dir":"","previous_headings":"","what":"概述","title":"数据生成功能优化总结","text":"本次优化完全重构了BulkS4包的数据生成系统，将原始的简单脚本转换为专业的、模块化的数据生成工具集。优化后的系统提供了完整的MSigDB基因集和示例数据生成功能，符合R包开发的最佳实践。","code":""},{"path":[]},{"path":[]},{"path":"https://hui950319.github.io/BulkS4/DATA_GENERATION_OPTIMIZATION.html","id":"优化前的问题","dir":"","previous_headings":"主要优化内容 > 1. 代码结构重组","what":"优化前的问题：","title":"数据生成功能优化总结","text":"msigdbr_geneset.R：依赖tidyverse，代码简单，缺乏错误处理 example_GSE150392.R：功能单一，缺乏验证和文档","code":""},{"path":"https://hui950319.github.io/BulkS4/DATA_GENERATION_OPTIMIZATION.html","id":"优化后的改进","dir":"","previous_headings":"主要优化内容 > 1. 代码结构重组","what":"优化后的改进：","title":"数据生成功能优化总结","text":"模块化设计：每个脚本专注于特定功能 统一接口：所有脚本使用相同的函数结构 完整文档：详细的函数说明和使用示例","code":""},{"path":[]},{"path":"https://hui950319.github.io/BulkS4/DATA_GENERATION_OPTIMIZATION.html","id":"id_21-核心功能函数","dir":"","previous_headings":"主要优化内容 > 2. MSigDB基因集生成优化 (msigdbr_geneset.R)","what":"2.1 核心功能函数","title":"数据生成功能优化总结","text":"get_msigdb_collections() - 安全获取MSigDB集合信息 - 完整的错误处理和状态报告 - 支持不同物种（默认人类） create_msigdbr_args() - 智能处理空的子集合 - 创建有意义的集合名称 - 参数验证和格式化 download_gene_sets() - 支持并行和串行处理 - 智能选择apply函数（pbapply或base） - 内存优化的数据处理 - 进度跟踪和错误恢复 validate_gene_sets() - 数据结构验证 - 统计信息计算 - 大小和质量检查","code":""},{"path":"https://hui950319.github.io/BulkS4/DATA_GENERATION_OPTIMIZATION.html","id":"id_22-技术改进","dir":"","previous_headings":"主要优化内容 > 2. MSigDB基因集生成优化 (msigdbr_geneset.R)","what":"2.2 技术改进","title":"数据生成功能优化总结","text":"改进亮点： - 移除tidyverse依赖，减少包体积 - 使用base R函数，提高兼容性 - 智能并行处理，自动检测可用核心数 - 完整的错误处理和恢复机制","code":"# 优化前（依赖tidyverse） library(tidyverse) rlang::exec(msigdbr::msigdbr, !!!args) %>%   dplyr::distinct(gs_name, gene_symbol)  # 优化后（使用base R） gs_data <- do.call(msigdbr::msigdbr, args) unique_sets <- unique(gs_data[, c(\"gs_name\", \"gene_symbol\")])"},{"path":[]},{"path":"https://hui950319.github.io/BulkS4/DATA_GENERATION_OPTIMIZATION.html","id":"id_31-核心功能函数","dir":"","previous_headings":"主要优化内容 > 3. 示例数据生成优化 (example_GSE150392.R)","what":"3.1 核心功能函数","title":"数据生成功能优化总结","text":"download_geo_data() - 自动GEO数据下载 - 网络错误处理和重试机制 - 临时目录管理 process_count_data() - 智能基因ID清理 - 集成去重功能（使用BulkS4包函数） - 数据格式标准化 create_metadata() - 灵活的分组模式识别 - 自动批次信息生成 - 完整的样本信息创建 validate_dataset() - 全面的数据验证 - 维度一致性检查 - 统计信息报告 create_example_subset() - 智能基因选择算法 - 基于表达水平和变异性的筛选 - 可重现的随机采样","code":""},{"path":"https://hui950319.github.io/BulkS4/DATA_GENERATION_OPTIMIZATION.html","id":"id_32-数据处理流程","dir":"","previous_headings":"主要优化内容 > 3. 示例数据生成优化 (example_GSE150392.R)","what":"3.2 数据处理流程","title":"数据生成功能优化总结","text":"","code":"# 优化后的完整流程 main <- function(create_subset = TRUE, subset_size = 1000) {   # 1. 下载数据   gset_sup <- download_geo_data(\"GSE150392\")      # 2. 处理计数数据   counts <- process_count_data(count_file)      # 3. 创建元数据   metadata <- create_metadata(colnames(counts))      # 4. 验证数据集   validate_dataset(counts, metadata)      # 5. 创建示例子集   if (create_subset) {     example_data <- create_example_subset(counts, metadata, n_genes = subset_size)     # 保存数据     usethis::use_data(example_counts, example_metadata, overwrite = TRUE)   }      return(processed_data) }"},{"path":[]},{"path":"https://hui950319.github.io/BulkS4/DATA_GENERATION_OPTIMIZATION.html","id":"id_41-协调功能","dir":"","previous_headings":"主要优化内容 > 4. 主控脚本创建 (generate_all_data.R)","what":"4.1 协调功能","title":"数据生成功能优化总结","text":"依赖检查：自动检测和安装所需包 进度跟踪：详细的执行状态报告 错误处理：优雅的错误恢复和报告 数据验证：生成后的完整性检查","code":""},{"path":"https://hui950319.github.io/BulkS4/DATA_GENERATION_OPTIMIZATION.html","id":"id_42-智能执行","dir":"","previous_headings":"主要优化内容 > 4. 主控脚本创建 (generate_all_data.R)","what":"4.2 智能执行","title":"数据生成功能优化总结","text":"","code":"main <- function(skip_existing = TRUE,                   generate_msigdb = TRUE,                   generate_examples = TRUE,                  subset_size = 1000,                  create_docs = TRUE) {   # 检查和安装包   check_and_install_packages()      # 条件执行   if (generate_msigdb) {     results$msigdb <- generate_msigdb_data(skip_if_exists = skip_existing)   }      if (generate_examples) {     results$examples <- generate_example_data(skip_if_exists = skip_existing)   }      # 验证和文档   validation <- validate_generated_data()   if (create_docs) create_data_documentation()      return(summary_results) }"},{"path":[]},{"path":"https://hui950319.github.io/BulkS4/DATA_GENERATION_OPTIMIZATION.html","id":"id_51-数据文档自动生成","dir":"","previous_headings":"主要优化内容 > 5. 文档和测试系统","what":"5.1 数据文档自动生成","title":"数据生成功能优化总结","text":"","code":"create_data_documentation <- function() {   # 自动生成R/data.R文件   # 包含完整的roxygen2文档   # 数据格式说明和使用示例 }"},{"path":"https://hui950319.github.io/BulkS4/DATA_GENERATION_OPTIMIZATION.html","id":"id_52-综合测试脚本-test_data_generationr","dir":"","previous_headings":"主要优化内容 > 5. 文档和测试系统","what":"5.2 综合测试脚本 (test_data_generation.R)","title":"数据生成功能优化总结","text":"脚本可用性测试：检查所有必需文件 依赖包测试：验证包安装状态 函数功能测试：单独测试每个核心函数 数据完整性测试：验证生成的数据质量 加载测试：确保数据可正确加载","code":""},{"path":[]},{"path":"https://hui950319.github.io/BulkS4/DATA_GENERATION_OPTIMIZATION.html","id":"id_61-description文件更新","dir":"","previous_headings":"主要优化内容 > 6. 包配置优化","what":"6.1 DESCRIPTION文件更新","title":"数据生成功能优化总结","text":"","code":"# 新增依赖 Suggests:     msigdbr,        # MSigDB基因集     GEOquery,       # GEO数据下载     usethis,        # 数据保存     devtools,       # 开发工具     pbapply,        # 进度条     parallel        # 并行处理"},{"path":"https://hui950319.github.io/BulkS4/DATA_GENERATION_OPTIMIZATION.html","id":"id_62-包描述改进","dir":"","previous_headings":"主要优化内容 > 6. 包配置优化","what":"6.2 包描述改进","title":"数据生成功能优化总结","text":"明确说明包含MSigDB基因集 强调示例数据的可用性 突出多数据源支持","code":""},{"path":[]},{"path":"https://hui950319.github.io/BulkS4/DATA_GENERATION_OPTIMIZATION.html","id":"id_1-性能优化","dir":"","previous_headings":"技术改进亮点","what":"1. 性能优化","title":"数据生成功能优化总结","text":"并行处理：MSigDB下载支持多核并行 内存管理：优化大数据集的内存使用 智能缓存：避免重复下载和处理 进度跟踪：实时显示处理进度","code":""},{"path":"https://hui950319.github.io/BulkS4/DATA_GENERATION_OPTIMIZATION.html","id":"id_2-错误处理","dir":"","previous_headings":"技术改进亮点","what":"2. 错误处理","title":"数据生成功能优化总结","text":"网络错误：自动重试和优雅降级 包依赖：智能检测和安装提示 数据验证：多层次的数据完整性检查 用户友好：清晰的错误消息和解决建议","code":""},{"path":"https://hui950319.github.io/BulkS4/DATA_GENERATION_OPTIMIZATION.html","id":"id_3-可扩展性","dir":"","previous_headings":"技术改进亮点","what":"3. 可扩展性","title":"数据生成功能优化总结","text":"模块化设计：易于添加新的数据源 配置灵活：支持自定义参数和选项 标准接口：统一的函数调用模式 文档完整：便于维护和扩展","code":""},{"path":"https://hui950319.github.io/BulkS4/DATA_GENERATION_OPTIMIZATION.html","id":"id_4-用户体验","dir":"","previous_headings":"技术改进亮点","what":"4. 用户体验","title":"数据生成功能优化总结","text":"一键生成：主脚本自动处理所有步骤 智能默认：合理的默认参数设置 详细反馈：实时状态和统计信息 故障恢复：支持中断后继续执行","code":""},{"path":[]},{"path":"https://hui950319.github.io/BulkS4/DATA_GENERATION_OPTIMIZATION.html","id":"msigdb基因集-geneset_msig","dir":"","previous_headings":"数据规格说明","what":"MSigDB基因集 (geneSet_msig)","title":"数据生成功能优化总结","text":"","code":"# 数据结构 str(geneSet_msig, max.level = 2) # List of 23 collections: #  $ H                : data.frame with gs_name and gene_symbol #  $ C1               : data.frame with gs_name and gene_symbol #  $ C2_CGP           : data.frame with gs_name and gene_symbol #  $ C2_CP            : data.frame with gs_name and gene_symbol #  ...  # 使用示例 hallmark_sets <- geneSet_msig$H kegg_pathways <- geneSet_msig$C2_CP_KEGG"},{"path":"https://hui950319.github.io/BulkS4/DATA_GENERATION_OPTIMIZATION.html","id":"示例数据-example_counts-example_metadata","dir":"","previous_headings":"数据规格说明","what":"示例数据 (example_counts, example_metadata)","title":"数据生成功能优化总结","text":"","code":"# 计数矩阵 dim(example_counts)      # 1000 genes × 24 samples class(example_counts)    # matrix storage.mode(example_counts)  # integer  # 元数据 dim(example_metadata)    # 24 samples × 4 variables colnames(example_metadata) # [1] \"sample_id\" \"group\"     \"condition\" \"batch\""},{"path":[]},{"path":"https://hui950319.github.io/BulkS4/DATA_GENERATION_OPTIMIZATION.html","id":"基本用法","dir":"","previous_headings":"使用指南","what":"基本用法","title":"数据生成功能优化总结","text":"","code":"# 生成所有数据 source(\"data-raw/generate_all_data.R\") main()  # 自定义选项 main(   skip_existing = FALSE,      # 重新生成现有数据   generate_msigdb = TRUE,     # 生成MSigDB基因集   generate_examples = TRUE,   # 生成示例数据   subset_size = 500,          # 示例数据基因数   create_docs = TRUE          # 创建文档 )"},{"path":"https://hui950319.github.io/BulkS4/DATA_GENERATION_OPTIMIZATION.html","id":"单独运行","dir":"","previous_headings":"使用指南","what":"单独运行","title":"数据生成功能优化总结","text":"","code":"# 仅生成MSigDB基因集 source(\"data-raw/msigdbr_geneset.R\") main()  # 仅生成示例数据 source(\"data-raw/example_GSE150392.R\") main(create_subset = TRUE, subset_size = 1000)"},{"path":"https://hui950319.github.io/BulkS4/DATA_GENERATION_OPTIMIZATION.html","id":"测试功能","dir":"","previous_headings":"使用指南","what":"测试功能","title":"数据生成功能优化总结","text":"","code":"# 运行测试脚本 source(\"test_data_generation.R\")"},{"path":[]},{"path":"https://hui950319.github.io/BulkS4/DATA_GENERATION_OPTIMIZATION.html","id":"生成时间","dir":"","previous_headings":"性能指标","what":"生成时间","title":"数据生成功能优化总结","text":"MSigDB基因集：5-15分钟（取决于网络速度） 示例数据：2-5分钟（取决于网络速度） 总计：10-20分钟","code":""},{"path":"https://hui950319.github.io/BulkS4/DATA_GENERATION_OPTIMIZATION.html","id":"数据大小","dir":"","previous_headings":"性能指标","what":"数据大小","title":"数据生成功能优化总结","text":"geneSet_msig.rda：~80 MB example_counts.rda：~1 MB example_metadata.rda：~1 KB 总计：~81 MB","code":""},{"path":"https://hui950319.github.io/BulkS4/DATA_GENERATION_OPTIMIZATION.html","id":"系统要求","dir":"","previous_headings":"性能指标","what":"系统要求","title":"数据生成功能优化总结","text":"内存：建议4GB以上（MSigDB生成时） 网络：稳定的互联网连接 存储：至少100MB可用空间","code":""},{"path":[]},{"path":"https://hui950319.github.io/BulkS4/DATA_GENERATION_OPTIMIZATION.html","id":"常见问题","dir":"","previous_headings":"故障排除","what":"常见问题","title":"数据生成功能优化总结","text":"使用稳定的网络环境 考虑使用机构网络 减少并行核心数 分别生成不同数据集 确保Bioconductor正确安装 检查系统依赖","code":""},{"path":"https://hui950319.github.io/BulkS4/DATA_GENERATION_OPTIMIZATION.html","id":"解决方案","dir":"","previous_headings":"故障排除","what":"解决方案","title":"数据生成功能优化总结","text":"","code":"# 网络问题 # 在脚本中设置更长的超时时间  # 内存问题 # 在msigdbr_geneset.R中设置： n_cores <- 1  # 减少并行核心数  # 包依赖问题 if (!requireNamespace(\"BiocManager\", quietly = TRUE))     install.packages(\"BiocManager\") BiocManager::install(c(\"GEOquery\", \"msigdbr\"))"},{"path":"https://hui950319.github.io/BulkS4/DATA_GENERATION_OPTIMIZATION.html","id":"未来扩展计划","dir":"","previous_headings":"","what":"未来扩展计划","title":"数据生成功能优化总结","text":"更多数据源：支持其他公共数据库 自定义基因集：允许用户添加自定义基因集 数据更新：定期更新MSigDB和示例数据 可视化：添加数据生成过程的可视化 云端支持：支持云端数据存储和访问","code":""},{"path":"https://hui950319.github.io/BulkS4/DATA_GENERATION_OPTIMIZATION.html","id":"总结","dir":"","previous_headings":"","what":"总结","title":"数据生成功能优化总结","text":"本次优化将简单的数据生成脚本转换为专业的数据管理系统，提供了： 完整的数据生成工具链 智能的错误处理和恢复 灵活的配置和扩展能力 全面的测试和验证 详细的文档和使用指南 这些改进使BulkS4包具备了企业级的数据管理能力，为用户提供了可靠、高效的数据生成解决方案。","code":""},{"path":[]},{"path":"https://hui950319.github.io/BulkS4/DIFFERENTIAL_ANALYSIS_OPTIMIZATION.html","id":"概述","dir":"","previous_headings":"","what":"概述","title":"差异表达分析功能优化总结","text":"本次优化将原始的data-raw/DEseq2_edgeR_limma-voom.R文件中的差异表达分析功能完全整合到BulkS4 R包中，提供了完整的、符合R包开发标准的差异表达分析工具集。","code":""},{"path":[]},{"path":[]},{"path":"https://hui950319.github.io/BulkS4/DIFFERENTIAL_ANALYSIS_OPTIMIZATION.html","id":"新增文件","dir":"","previous_headings":"主要优化内容 > 1. 代码结构重组","what":"新增文件：","title":"差异表达分析功能优化总结","text":"R/differential_analysis.R - 核心差异表达分析函数 R/analysis_methods.R - 与BulkRNAseq S4对象集成的分析方法 test_differential_analysis.R - 完整的功能测试脚本","code":""},{"path":"https://hui950319.github.io/BulkS4/DIFFERENTIAL_ANALYSIS_OPTIMIZATION.html","id":"删除文件","dir":"","previous_headings":"主要优化内容 > 1. 代码结构重组","what":"删除文件：","title":"差异表达分析功能优化总结","text":"data-raw/DEseq2_edgeR_limma-voom.R - 原始未优化代码","code":""},{"path":[]},{"path":"https://hui950319.github.io/BulkS4/DIFFERENTIAL_ANALYSIS_OPTIMIZATION.html","id":"id_21-基因去重函数-dedup_genes","dir":"","previous_headings":"主要优化内容 > 2. 核心功能函数 (R/differential_analysis.R)","what":"2.1 基因去重函数 dedup_genes()","title":"差异表达分析功能优化总结","text":"优化前问题：依赖tidyverse，代码冗余，错误处理不完善 移除外部依赖，使用base R函数 增强输入验证和错误处理 优化内存使用和性能 完善的roxygen2文档","code":""},{"path":"https://hui950319.github.io/BulkS4/DIFFERENTIAL_ANALYSIS_OPTIMIZATION.html","id":"id_22-基因id转换函数-convert_genes","dir":"","previous_headings":"主要优化内容 > 2. 核心功能函数 (R/differential_analysis.R)","what":"2.2 基因ID转换函数 convert_genes()","title":"差异表达分析功能优化总结","text":"优化前问题：错误处理简单，输出格式不统一 增强包依赖检查 统一输出格式 改进转换统计信息显示 更好的错误消息","code":""},{"path":"https://hui950319.github.io/BulkS4/DIFFERENTIAL_ANALYSIS_OPTIMIZATION.html","id":"id_23-差异表达分析函数","dir":"","previous_headings":"主要优化内容 > 2. 核心功能函数 (R/differential_analysis.R)","what":"2.3 差异表达分析函数","title":"差异表达分析功能优化总结","text":"run_DESeq2() - DESeq2分析 run_edgeR() - edgeR分析 run_limma_voom() - limma-voom分析 优化改进： - 统一函数接口和返回格式 - 增强输入验证 - 改进错误处理 - 使用命名空间避免包冲突 - 完整的参数文档","code":""},{"path":[]},{"path":"https://hui950319.github.io/BulkS4/DIFFERENTIAL_ANALYSIS_OPTIMIZATION.html","id":"id_31-主要分析函数-rundiffanalysis","dir":"","previous_headings":"主要优化内容 > 3. S4对象集成方法 (R/analysis_methods.R)","what":"3.1 主要分析函数 runDiffAnalysis()","title":"差异表达分析功能优化总结","text":"与BulkRNAseq S4对象无缝集成 支持灵活的分组列指定 自动结果命名和存储 详细的分析统计输出","code":""},{"path":"https://hui950319.github.io/BulkS4/DIFFERENTIAL_ANALYSIS_OPTIMIZATION.html","id":"id_32-方法比较函数-comparediffmethods","dir":"","previous_headings":"主要优化内容 > 3. S4对象集成方法 (R/analysis_methods.R)","what":"3.2 方法比较函数 compareDiffMethods()","title":"差异表达分析功能优化总结","text":"一次运行多种分析方法 自动比较分析结果 识别共同显著基因 生成比较统计","code":""},{"path":"https://hui950319.github.io/BulkS4/DIFFERENTIAL_ANALYSIS_OPTIMIZATION.html","id":"id_33-结果提取和管理","dir":"","previous_headings":"主要优化内容 > 3. S4对象集成方法 (R/analysis_methods.R)","what":"3.3 结果提取和管理","title":"差异表达分析功能优化总结","text":"extractDiffResults() - 提取特定分析结果 getAnalysisSummary() - 获取所有分析的汇总统计","code":""},{"path":[]},{"path":"https://hui950319.github.io/BulkS4/DIFFERENTIAL_ANALYSIS_OPTIMIZATION.html","id":"id_41-description文件更新","dir":"","previous_headings":"主要优化内容 > 4. 包配置优化","what":"4.1 DESCRIPTION文件更新","title":"差异表达分析功能优化总结","text":"","code":"# 新增依赖包 Suggests:     testthat (>= 3.0.0),     DESeq2,     edgeR,     limma,     clusterProfiler,     biomaRt,     SummarizedExperiment,     org.Hs.eg.db"},{"path":"https://hui950319.github.io/BulkS4/DIFFERENTIAL_ANALYSIS_OPTIMIZATION.html","id":"id_42-包描述改进","dir":"","previous_headings":"主要优化内容 > 4. 包配置优化","what":"4.2 包描述改进","title":"差异表达分析功能优化总结","text":"更详细的功能描述 明确支持的分析方法 强调多方法比较能力","code":""},{"path":[]},{"path":"https://hui950319.github.io/BulkS4/DIFFERENTIAL_ANALYSIS_OPTIMIZATION.html","id":"id_51-综合测试脚本-test_differential_analysisr","dir":"","previous_headings":"主要优化内容 > 5. 测试和验证","what":"5.1 综合测试脚本 (test_differential_analysis.R)","title":"差异表达分析功能优化总结","text":"BulkRNAseq对象创建 基因去重功能 三种差异表达分析方法 S4对象集成分析 多方法比较 结果提取和汇总 自动检测可用的分析包 跳过不可用的测试 详细的错误报告 安装指导信息","code":""},{"path":"https://hui950319.github.io/BulkS4/DIFFERENTIAL_ANALYSIS_OPTIMIZATION.html","id":"id_52-模拟数据生成","dir":"","previous_headings":"主要优化内容 > 5. 测试和验证","what":"5.2 模拟数据生成","title":"差异表达分析功能优化总结","text":"创建具有真实差异表达模式的测试数据 包含批次效应和实验设计 可重现的随机种子","code":""},{"path":[]},{"path":"https://hui950319.github.io/BulkS4/DIFFERENTIAL_ANALYSIS_OPTIMIZATION.html","id":"id_1-代码质量提升","dir":"","previous_headings":"技术改进亮点","what":"1. 代码质量提升","title":"差异表达分析功能优化总结","text":"错误处理：使用call. = FALSE提供清晰错误信息 输入验证：全面的参数检查和类型验证 内存优化：避免不必要的数据复制 命名空间：正确使用::避免函数冲突","code":""},{"path":"https://hui950319.github.io/BulkS4/DIFFERENTIAL_ANALYSIS_OPTIMIZATION.html","id":"id_2-用户体验改进","dir":"","previous_headings":"技术改进亮点","what":"2. 用户体验改进","title":"差异表达分析功能优化总结","text":"统一接口：所有分析函数使用相同的参数结构 详细输出：提供分析进度和结果统计 灵活配置：支持自定义阈值和参数 智能默认值：合理的默认参数设置","code":""},{"path":"https://hui950319.github.io/BulkS4/DIFFERENTIAL_ANALYSIS_OPTIMIZATION.html","id":"id_3-文档完善","dir":"","previous_headings":"技术改进亮点","what":"3. 文档完善","title":"差异表达分析功能优化总结","text":"roxygen2文档：每个函数都有完整的参数说明和示例 使用示例：提供实际可运行的代码示例 最佳实践：在文档中包含使用建议","code":""},{"path":"https://hui950319.github.io/BulkS4/DIFFERENTIAL_ANALYSIS_OPTIMIZATION.html","id":"id_4-扩展性设计","dir":"","previous_headings":"技术改进亮点","what":"4. 扩展性设计","title":"差异表达分析功能优化总结","text":"模块化结构：功能分离，易于维护和扩展 标准化输出：统一的结果格式便于后续分析 插件架构：易于添加新的分析方法","code":""},{"path":[]},{"path":"https://hui950319.github.io/BulkS4/DIFFERENTIAL_ANALYSIS_OPTIMIZATION.html","id":"基本用法","dir":"","previous_headings":"使用示例","what":"基本用法","title":"差异表达分析功能优化总结","text":"","code":"# 加载包 library(BulkS4)  # 创建BulkRNAseq对象 bulk_obj <- BulkRNAseq(counts_matrix, metadata)  # 运行DESeq2分析 bulk_obj <- runDiffAnalysis(bulk_obj, method = \"DESeq2\",                             group_col = \"condition\",                            treat_level = \"Treatment\",                             control_level = \"Control\")  # 比较多种方法 bulk_obj <- compareDiffMethods(bulk_obj,                                methods = c(\"DESeq2\", \"edgeR\", \"limma_voom\"))  # 提取结果 results <- extractDiffResults(bulk_obj, \"DESeq2_Treatment_vs_Control\") summary <- getAnalysisSummary(bulk_obj)"},{"path":"https://hui950319.github.io/BulkS4/DIFFERENTIAL_ANALYSIS_OPTIMIZATION.html","id":"独立函数使用","dir":"","previous_headings":"使用示例","what":"独立函数使用","title":"差异表达分析功能优化总结","text":"","code":"# 基因去重 clean_data <- dedup_genes(expression_data, method = \"max_mean\")  # 基因ID转换 converted_data <- convert_genes(expression_matrix,                                 from_type = \"ENSEMBL\",                                 to_type = \"SYMBOL\")  # 直接运行分析 result <- run_DESeq2(counts, metadata)"},{"path":[]},{"path":"https://hui950319.github.io/BulkS4/DIFFERENTIAL_ANALYSIS_OPTIMIZATION.html","id":"必需依赖","dir":"","previous_headings":"兼容性和依赖","what":"必需依赖","title":"差异表达分析功能优化总结","text":"R (>= 4.0.0) methods cli","code":""},{"path":"https://hui950319.github.io/BulkS4/DIFFERENTIAL_ANALYSIS_OPTIMIZATION.html","id":"可选依赖用于分析功能","dir":"","previous_headings":"兼容性和依赖","what":"可选依赖（用于分析功能）","title":"差异表达分析功能优化总结","text":"DESeq2 - DESeq2差异表达分析 edgeR - edgeR差异表达分析 limma - limma-voom差异表达分析 clusterProfiler - 基因ID转换 biomaRt - 基因ID转换（备选） SummarizedExperiment - DESeq2支持 org.Hs.eg.db - 人类基因注释","code":""},{"path":"https://hui950319.github.io/BulkS4/DIFFERENTIAL_ANALYSIS_OPTIMIZATION.html","id":"安装建议","dir":"","previous_headings":"兼容性和依赖","what":"安装建议","title":"差异表达分析功能优化总结","text":"","code":"# 安装Bioconductor包 if (!requireNamespace(\"BiocManager\", quietly = TRUE))     install.packages(\"BiocManager\")  BiocManager::install(c(\"DESeq2\", \"edgeR\", \"limma\", \"clusterProfiler\",                         \"biomaRt\", \"SummarizedExperiment\", \"org.Hs.eg.db\"))"},{"path":"https://hui950319.github.io/BulkS4/DIFFERENTIAL_ANALYSIS_OPTIMIZATION.html","id":"未来扩展计划","dir":"","previous_headings":"","what":"未来扩展计划","title":"差异表达分析功能优化总结","text":"可视化功能：添加火山图、热图等可视化方法 更多分析方法：支持其他差异表达分析工具 批量效应处理：集成批量效应校正方法 报告生成：自动生成分析报告 并行计算：支持多核并行分析","code":""},{"path":"https://hui950319.github.io/BulkS4/DIFFERENTIAL_ANALYSIS_OPTIMIZATION.html","id":"总结","dir":"","previous_headings":"","what":"总结","title":"差异表达分析功能优化总结","text":"本次优化将原始的分析脚本转换为专业的R包功能，提供了： - 完整的差异表达分析工具集 - 与S4对象系统的无缝集成 - 多方法比较和结果管理 - 全面的测试和文档 - 良好的扩展性和维护性 这些改进使BulkS4包成为一个功能完整、易于使用的bulk RNA-seq数据分析工具。","code":""},{"path":[]},{"path":"https://hui950319.github.io/BulkS4/GSEA_GSVA_OPTIMIZATION.html","id":"概述","dir":"","previous_headings":"","what":"概述","title":"GSEA和GSVA功能优化总结","text":"本次优化完全重构了BulkS4包中的GSEA（基因集富集分析）和GSVA（基因集变异分析）功能，将原始的简单实现转换为专业的、功能完整的分析工具。优化后的系统提供了完整的基因集分析功能，符合R包开发的最佳实践。","code":""},{"path":[]},{"path":[]},{"path":"https://hui950319.github.io/BulkS4/GSEA_GSVA_OPTIMIZATION.html","id":"id_11-优化前的问题","dir":"","previous_headings":"主要优化内容 > 1. GSEA功能优化 (R/gsea.R)","what":"1.1 优化前的问题","title":"GSEA和GSVA功能优化总结","text":"缺乏完整的roxygen2文档 错误处理不完善 参数验证不足 依赖管道操作符（%>%） 功能单一，缺乏灵活性","code":""},{"path":"https://hui950319.github.io/BulkS4/GSEA_GSVA_OPTIMIZATION.html","id":"id_12-优化后的改进","dir":"","previous_headings":"主要优化内容 > 1. GSEA功能优化 (R/gsea.R)","what":"1.2 优化后的改进","title":"GSEA和GSVA功能优化总结","text":"完整的函数文档 增强的参数验证 模块化的辅助函数 - get_diff_results(): 获取差异表达结果 - prepare_gene_ranking(): 准备基因排序列表 - get_gene_sets(): 获取和验证基因集 改进的错误处理","code":"#' @title Gene Set Enrichment Analysis (GSEA) for BulkRNAseq Objects #' @description Perform Gene Set Enrichment Analysis using clusterProfiler #' @param object A BulkRNAseq object containing differential expression results #' @param geneSet_name Character vector, names of gene sets to analyze #' @param analysis_name Character, name of differential analysis results to use #' @param logfc_col Character, column name for log fold change values #' @param geneid_col Character, column name for gene identifiers #' @param pvalueCutoff Numeric, p-value cutoff for significance #' @param pAdjustMethod Character, p-value adjustment method #' @param minGSSize Integer, minimum gene set size #' @param maxGSSize Integer, maximum gene set size #' @param verbose Logical, whether to print progress messages # 输入验证 if (!inherits(object, \"BulkRNAseq\")) {   stop(\"object must be a BulkRNAseq object\", call. = FALSE) }  # 参数验证 if (!is.numeric(pvalueCutoff) || pvalueCutoff <= 0 || pvalueCutoff > 1) {   stop(\"pvalueCutoff must be a number between 0 and 1\", call. = FALSE) } gsea_result <- tryCatch({   clusterProfiler::GSEA(...) }, error = function(e) {   stop(\"GSEA analysis failed: \", e$message, call. = FALSE) })"},{"path":[]},{"path":"https://hui950319.github.io/BulkS4/GSEA_GSVA_OPTIMIZATION.html","id":"id_21-优化前的问题","dir":"","previous_headings":"主要优化内容 > 2. GSVA功能优化 (R/gsva.R)","what":"2.1 优化前的问题","title":"GSEA和GSVA功能优化总结","text":"依赖dplyr和tidyverse 缺乏参数灵活性 错误处理不完善 代码结构不清晰","code":""},{"path":"https://hui950319.github.io/BulkS4/GSEA_GSVA_OPTIMIZATION.html","id":"id_22-优化后的改进","dir":"","previous_headings":"主要优化内容 > 2. GSVA功能优化 (R/gsva.R)","what":"2.2 优化后的改进","title":"GSEA和GSVA功能优化总结","text":"移除外部依赖 增强的参数控制 模块化的辅助函数 - get_expression_data(): 获取和验证表达数据 - get_and_process_gene_sets(): 处理基因集数据 - perform_gsva_analysis(): 执行GSVA分析 - perform_limma_analysis(): 执行limma差异分析 智能的分析流程","code":"# 优化前（使用dplyr） geneSet_lis <- object@geneSet[[geneSet_name]] %>%    base::split(x = .$gene_symbol, f = .$gs_name)  # 优化后（使用base R） geneSet_list <- split(geneSet_df$gene_symbol, geneSet_df$gs_name) setGeneric(\"gsva\", function(object,                             geneSet_name = \"H\",                             gsva_method = c(\"gsva\", \"ssgsea\"),                            kcdf = \"Gaussian\",                            min_sz = 1,                            max_sz = Inf,                            mx_diff = TRUE,                            tau = 1,                            ssgsea_norm = TRUE,                            run_limma = TRUE,                            verbose = TRUE) # 条件执行limma分析 if (run_limma) {   diff_results <- perform_limma_analysis(object, gsva_scores, geneSet_name, verbose)   if (!is.null(diff_results)) {     object@allDiff[[geneSet_name]] <- diff_results   } }"},{"path":[]},{"path":"https://hui950319.github.io/BulkS4/GSEA_GSVA_OPTIMIZATION.html","id":"id_31-代码质量提升","dir":"","previous_headings":"主要优化内容 > 3. 技术改进亮点","what":"3.1 代码质量提升","title":"GSEA和GSVA功能优化总结","text":"移除管道依赖: 使用base R函数替代tidyverse 模块化设计: 将复杂功能分解为独立的辅助函数 统一接口: 两个方法使用相似的参数结构和调用模式 完整文档: 添加详细的roxygen2文档和使用示例","code":""},{"path":"https://hui950319.github.io/BulkS4/GSEA_GSVA_OPTIMIZATION.html","id":"id_32-错误处理改进","dir":"","previous_headings":"主要优化内容 > 3. 技术改进亮点","what":"3.2 错误处理改进","title":"GSEA和GSVA功能优化总结","text":"","code":"# 包依赖检查 if (!requireNamespace(\"clusterProfiler\", quietly = TRUE)) {   stop(\"Package 'clusterProfiler' is required for GSEA analysis. \",        \"Install with: BiocManager::install('clusterProfiler')\", call. = FALSE) }  # 数据验证 if (!all(required_cols %in% colnames(geneSet))) {   stop(\"Gene set must contain columns: \", paste(required_cols, collapse = \", \"), call. = FALSE) }"},{"path":"https://hui950319.github.io/BulkS4/GSEA_GSVA_OPTIMIZATION.html","id":"id_33-性能优化","dir":"","previous_headings":"主要优化内容 > 3. 技术改进亮点","what":"3.3 性能优化","title":"GSEA和GSVA功能优化总结","text":"内存管理: 优化大数据集的处理 数据清理: 自动移除缺失值和重复项 智能默认: 合理的默认参数设置","code":""},{"path":"https://hui950319.github.io/BulkS4/GSEA_GSVA_OPTIMIZATION.html","id":"id_34-用户体验改进","dir":"","previous_headings":"主要优化内容 > 3. 技术改进亮点","what":"3.4 用户体验改进","title":"GSEA和GSVA功能优化总结","text":"详细反馈: 可选的详细进度信息 灵活配置: 支持多种分析参数 批量处理: 支持多个基因集的同时分析","code":""},{"path":[]},{"path":"https://hui950319.github.io/BulkS4/GSEA_GSVA_OPTIMIZATION.html","id":"id_41-gsea方法增强","dir":"","previous_headings":"主要优化内容 > 4. 新增功能特性","what":"4.1 GSEA方法增强","title":"GSEA和GSVA功能优化总结","text":"多分析支持: 可指定使用哪个差异分析结果 参数控制: 完整的GSEA参数控制（minGSSize, maxGSSize等） 结果统计: 自动报告显著富集的基因集数量","code":""},{"path":"https://hui950319.github.io/BulkS4/GSEA_GSVA_OPTIMIZATION.html","id":"id_42-gsva方法增强","dir":"","previous_headings":"主要优化内容 > 4. 新增功能特性","what":"4.2 GSVA方法增强","title":"GSEA和GSVA功能优化总结","text":"方法选择: 支持GSVA和ssGSEA两种方法 核函数选择: 支持Gaussian、Poisson、none三种核函数 可选差异分析: 可选择是否进行后续的limma分析 参数优化: 支持tau、normalize等ssGSEA特定参数","code":""},{"path":"https://hui950319.github.io/BulkS4/GSEA_GSVA_OPTIMIZATION.html","id":"id_43-批量分析支持","dir":"","previous_headings":"主要优化内容 > 4. 新增功能特性","what":"4.3 批量分析支持","title":"GSEA和GSVA功能优化总结","text":"","code":"# 同时分析多个基因集 bulk_obj <- gsea(bulk_obj, geneSet_name = c(\"H\", \"C2_CP_KEGG\", \"C5_GO_BP\")) bulk_obj <- gsva(bulk_obj, geneSet_name = c(\"H\", \"C2_CP_KEGG\"))"},{"path":[]},{"path":"https://hui950319.github.io/BulkS4/GSEA_GSVA_OPTIMIZATION.html","id":"id_51-namespace更新","dir":"","previous_headings":"主要优化内容 > 5. 包配置更新","what":"5.1 NAMESPACE更新","title":"GSEA和GSVA功能优化总结","text":"","code":"export(gsea) export(gsva) exportMethods(gsea) exportMethods(gsva)"},{"path":"https://hui950319.github.io/BulkS4/GSEA_GSVA_OPTIMIZATION.html","id":"id_52-description更新","dir":"","previous_headings":"主要优化内容 > 5. 包配置更新","what":"5.2 DESCRIPTION更新","title":"GSEA和GSVA功能优化总结","text":"","code":"Suggests:     clusterProfiler,  # GSEA分析     GSVA,            # GSVA分析     limma,           # 差异分析"},{"path":[]},{"path":"https://hui950319.github.io/BulkS4/GSEA_GSVA_OPTIMIZATION.html","id":"id_61-综合测试脚本-test_gsea_gsvar","dir":"","previous_headings":"主要优化内容 > 6. 测试系统建立","what":"6.1 综合测试脚本 (test_gsea_gsva.R)","title":"GSEA和GSVA功能优化总结","text":"方法可用性测试: 检查函数是否正确导出 包依赖测试: 验证所需包的安装状态 功能测试: 使用模拟数据测试核心功能 参数验证测试: 测试参数验证机制 错误处理测试: 验证错误处理的正确性 批量分析测试: 测试多基因集分析功能","code":""},{"path":"https://hui950319.github.io/BulkS4/GSEA_GSVA_OPTIMIZATION.html","id":"id_62-测试覆盖范围","dir":"","previous_headings":"主要优化内容 > 6. 测试系统建立","what":"6.2 测试覆盖范围","title":"GSEA和GSVA功能优化总结","text":"","code":"# 基本功能测试 bulk_obj <- gsea(bulk_obj, geneSet_name = \"test_geneset\") bulk_obj <- gsva(bulk_obj, geneSet_name = \"test_geneset\")  # 参数测试 bulk_obj <- gsea(bulk_obj, pvalueCutoff = 0.01, minGSSize = 10) bulk_obj <- gsva(bulk_obj, gsva_method = \"ssgsea\", kcdf = \"Poisson\")  # 批量测试 bulk_obj <- gsea(bulk_obj, geneSet_name = c(\"set1\", \"set2\"))"},{"path":[]},{"path":[]},{"path":"https://hui950319.github.io/BulkS4/GSEA_GSVA_OPTIMIZATION.html","id":"gsea分析","dir":"","previous_headings":"使用指南 > 基本用法","what":"GSEA分析","title":"GSEA和GSVA功能优化总结","text":"","code":"# 基本GSEA分析 bulk_obj <- gsea(bulk_obj, geneSet_name = \"H\")  # 指定分析结果 bulk_obj <- gsea(bulk_obj,                  geneSet_name = \"H\",                 analysis_name = \"DESeq2_results\")  # 自定义参数 bulk_obj <- gsea(bulk_obj,                  geneSet_name = \"H\",                 pvalueCutoff = 0.01,                 minGSSize = 10,                 maxGSSize = 200)"},{"path":"https://hui950319.github.io/BulkS4/GSEA_GSVA_OPTIMIZATION.html","id":"gsva分析","dir":"","previous_headings":"使用指南 > 基本用法","what":"GSVA分析","title":"GSEA和GSVA功能优化总结","text":"","code":"# 基本GSVA分析 bulk_obj <- gsva(bulk_obj, geneSet_name = \"H\")  # ssGSEA分析 bulk_obj <- gsva(bulk_obj,                  geneSet_name = \"H\",                 gsva_method = \"ssgsea\")  # 自定义参数 bulk_obj <- gsva(bulk_obj,                  geneSet_name = \"H\",                 kcdf = \"Poisson\",                 min_sz = 10,                 max_sz = 200,                 run_limma = FALSE)"},{"path":"https://hui950319.github.io/BulkS4/GSEA_GSVA_OPTIMIZATION.html","id":"批量分析","dir":"","previous_headings":"使用指南 > 基本用法","what":"批量分析","title":"GSEA和GSVA功能优化总结","text":"","code":"# 多个基因集同时分析 gene_sets <- c(\"H\", \"C2_CP_KEGG\", \"C5_GO_BP\") bulk_obj <- gsea(bulk_obj, geneSet_name = gene_sets) bulk_obj <- gsva(bulk_obj, geneSet_name = gene_sets)"},{"path":[]},{"path":"https://hui950319.github.io/BulkS4/GSEA_GSVA_OPTIMIZATION.html","id":"结果访问","dir":"","previous_headings":"使用指南 > 高级用法","what":"结果访问","title":"GSEA和GSVA功能优化总结","text":"","code":"# 访问GSEA结果 gsea_results <- bulk_obj@gsea[[\"H\"]] head(gsea_results@result)  # 访问GSVA结果 gsva_scores <- bulk_obj@gsva[[\"H\"]] head(gsva_scores)  # 访问GSVA差异分析结果 gsva_diff <- bulk_obj@allDiff[[\"H\"]] head(gsva_diff)"},{"path":"https://hui950319.github.io/BulkS4/GSEA_GSVA_OPTIMIZATION.html","id":"参数优化建议","dir":"","previous_headings":"使用指南 > 高级用法","what":"参数优化建议","title":"GSEA和GSVA功能优化总结","text":"","code":"# 对于count数据，建议使用Poisson核函数 bulk_obj <- gsva(bulk_obj, kcdf = \"Poisson\")  # 对于大基因集，可以设置大小限制 bulk_obj <- gsea(bulk_obj, minGSSize = 15, maxGSSize = 500)  # 对于探索性分析，可以放宽p值阈值 bulk_obj <- gsea(bulk_obj, pvalueCutoff = 0.1)"},{"path":[]},{"path":"https://hui950319.github.io/BulkS4/GSEA_GSVA_OPTIMIZATION.html","id":"分析速度","dir":"","previous_headings":"性能指标","what":"分析速度","title":"GSEA和GSVA功能优化总结","text":"GSEA分析: 1-5分钟（取决于基因集大小） GSVA分析: 2-10分钟（取决于基因集和样本数量） 批量分析: 线性增长，支持并行优化","code":""},{"path":"https://hui950319.github.io/BulkS4/GSEA_GSVA_OPTIMIZATION.html","id":"内存使用","dir":"","previous_headings":"性能指标","what":"内存使用","title":"GSEA和GSVA功能优化总结","text":"优化前: 高内存使用（tidyverse依赖） 优化后: 显著降低内存占用（base R实现）","code":""},{"path":"https://hui950319.github.io/BulkS4/GSEA_GSVA_OPTIMIZATION.html","id":"兼容性","dir":"","previous_headings":"性能指标","what":"兼容性","title":"GSEA和GSVA功能优化总结","text":"R版本: >= 4.0.0 依赖包: 最小化外部依赖 平台: 跨平台兼容","code":""},{"path":[]},{"path":"https://hui950319.github.io/BulkS4/GSEA_GSVA_OPTIMIZATION.html","id":"常见问题","dir":"","previous_headings":"故障排除","what":"常见问题","title":"GSEA和GSVA功能优化总结","text":"包依赖问题 基因ID不匹配 内存不足","code":"# 安装所需的Bioconductor包 BiocManager::install(c(\"clusterProfiler\", \"GSVA\", \"limma\")) # 检查基因集和表达数据的基因ID格式 head(rownames(bulk_obj@data)) head(unique(bulk_obj@geneSet[[\"H\"]]$gene_symbol)) # 减少基因集大小 bulk_obj <- gsva(bulk_obj, max_sz = 200)  # 分批处理大基因集 gene_sets_batch1 <- c(\"H\", \"C2_CP_KEGG\") gene_sets_batch2 <- c(\"C5_GO_BP\", \"C5_GO_MF\")"},{"path":"https://hui950319.github.io/BulkS4/GSEA_GSVA_OPTIMIZATION.html","id":"错误解决方案","dir":"","previous_headings":"故障排除","what":"错误解决方案","title":"GSEA和GSVA功能优化总结","text":"","code":"# 如果GSEA失败，检查差异分析结果 if (length(bulk_obj@allDiff) == 0) {   # 先运行差异分析   bulk_obj <- runDiffAnalysis(bulk_obj, method = \"DESeq2\") }  # 如果GSVA失败，检查表达数据 if (is.null(bulk_obj@data)) {   # 确保数据槽已填充   bulk_obj@data <- log2(bulk_obj@counts + 1) }"},{"path":"https://hui950319.github.io/BulkS4/GSEA_GSVA_OPTIMIZATION.html","id":"未来扩展计划","dir":"","previous_headings":"","what":"未来扩展计划","title":"GSEA和GSVA功能优化总结","text":"可视化功能: 添加GSEA和GSVA结果的可视化方法 报告生成: 自动生成分析报告 并行计算: 支持多核并行处理 更多方法: 集成其他基因集分析方法 交互式分析: 支持Shiny应用集成","code":""},{"path":"https://hui950319.github.io/BulkS4/GSEA_GSVA_OPTIMIZATION.html","id":"总结","dir":"","previous_headings":"","what":"总结","title":"GSEA和GSVA功能优化总结","text":"本次优化将简单的GSEA和GSVA实现转换为专业的基因集分析工具，提供了： 完整的功能覆盖: 支持GSEA和GSVA的主要分析需求 灵活的参数控制: 丰富的参数选项满足不同分析需求 强大的错误处理: 全面的验证和错误恢复机制 优秀的用户体验: 清晰的文档和友好的接口 高效的性能: 优化的算法和内存使用 这些改进使BulkS4包具备了企业级的基因集分析能力，为用户提供了可靠、高效的分析解决方案。","code":""},{"path":[]},{"path":"https://hui950319.github.io/BulkS4/IMPORT_OPTIMIZATION.html","id":"概述","dir":"","previous_headings":"","what":"概述","title":"R包函数Import语句优化总结","text":"本次优化为BulkS4包中的所有R函数添加了适当的import语句，确保包的依赖关系明确声明，提高代码的可维护性和稳定性。这是R包开发的最佳实践，有助于避免命名空间冲突和依赖问题。","code":""},{"path":[]},{"path":"https://hui950319.github.io/BulkS4/IMPORT_OPTIMIZATION.html","id":"id_1-s4class_defr","dir":"","previous_headings":"优化内容","what":"1. S4class_def.R","title":"R包函数Import语句优化总结","text":"添加的import语句： 说明： - methods::new: 用于创建S4对象实例 - methods::setClass: 用于定义S4类 - cli::col_blue: 用于在show方法中显示彩色文本","code":"#' @importFrom methods new setClass #' @importFrom cli col_blue"},{"path":"https://hui950319.github.io/BulkS4/IMPORT_OPTIMIZATION.html","id":"id_2-methodsr","dir":"","previous_headings":"优化内容","what":"2. methods.R","title":"R包函数Import语句优化总结","text":"添加的import语句： 说明： - methods::setMethod: 用于定义S4方法 - methods::new: 用于在子集化方法中创建新对象 - cli::col_blue: 用于show方法的彩色输出","code":"#' @importFrom methods setMethod new #' @importFrom cli col_blue"},{"path":"https://hui950319.github.io/BulkS4/IMPORT_OPTIMIZATION.html","id":"id_3-utilsr","dir":"","previous_headings":"优化内容","what":"3. utils.R","title":"R包函数Import语句优化总结","text":"添加的import语句： 说明： - methods::: 用于对象类型检查（虽然当前使用inherits，但为未来扩展预留） 函数改进： - 为summary.BulkRNAseq函数添加了...参数，提高S3方法兼容性","code":"#' @importFrom methods is"},{"path":"https://hui950319.github.io/BulkS4/IMPORT_OPTIMIZATION.html","id":"id_4-differential_analysisr","dir":"","previous_headings":"优化内容","what":"4. differential_analysis.R","title":"R包函数Import语句优化总结","text":"添加的import语句： 说明： - stats::complete.cases: 用于检查完整的数据行 - stats::aggregate: 用于基因去重时的数据聚合 - stats::var: 用于计算方差 - utils::head: 用于数据预览 函数改进： - 优化了convert_genes函数的数据处理流程 - 改进了统计信息的显示格式","code":"#' @importFrom stats complete.cases aggregate var #' @importFrom utils head"},{"path":"https://hui950319.github.io/BulkS4/IMPORT_OPTIMIZATION.html","id":"id_5-analysis_methodsr","dir":"","previous_headings":"优化内容","what":"5. analysis_methods.R","title":"R包函数Import语句优化总结","text":"添加的import语句： 说明： - stats::setNames: 用于设置命名向量 - utils::head: 用于数据预览 - utils::tail: 用于数据尾部预览","code":"#' @importFrom stats setNames #' @importFrom utils head tail"},{"path":"https://hui950319.github.io/BulkS4/IMPORT_OPTIMIZATION.html","id":"id_6-gsear","dir":"","previous_headings":"优化内容","what":"6. gsea.R","title":"R包函数Import语句优化总结","text":"添加的import语句： 说明： - methods::setGeneric: 用于定义泛型函数 - methods::setMethod: 用于定义S4方法 - stats::setNames: 用于创建命名的基因排序向量 - stats::complete.cases: 用于数据完整性检查","code":"#' @importFrom methods setGeneric setMethod #' @importFrom stats setNames complete.cases"},{"path":"https://hui950319.github.io/BulkS4/IMPORT_OPTIMIZATION.html","id":"id_7-gsvar","dir":"","previous_headings":"优化内容","what":"7. gsva.R","title":"R包函数Import语句优化总结","text":"添加的import语句： 说明： - methods::setGeneric: 用于定义泛型函数 - methods::setMethod: 用于定义S4方法 - stats::complete.cases: 用于数据完整性检查 - stats::model.matrix: 用于limma分析中的设计矩阵创建","code":"#' @importFrom methods setGeneric setMethod #' @importFrom stats complete.cases model.matrix"},{"path":"https://hui950319.github.io/BulkS4/IMPORT_OPTIMIZATION.html","id":"namespace文件更新","dir":"","previous_headings":"","what":"NAMESPACE文件更新","title":"R包函数Import语句优化总结","text":"新增的importFrom语句：","code":"importFrom(cli,col_blue) importFrom(methods,is) importFrom(methods,new) importFrom(methods,setClass) importFrom(methods,setGeneric) importFrom(methods,setMethod) importFrom(stats,aggregate) importFrom(stats,complete.cases) importFrom(stats,model.matrix) importFrom(stats,setNames) importFrom(stats,var) importFrom(utils,head) importFrom(utils,tail)"},{"path":[]},{"path":"https://hui950319.github.io/BulkS4/IMPORT_OPTIMIZATION.html","id":"id_1-依赖关系明确化","dir":"","previous_headings":"优化效果","what":"1. 依赖关系明确化","title":"R包函数Import语句优化总结","text":"明确声明：所有使用的外部函数都有明确的import声明 避免冲突：减少命名空间冲突的可能性 提高稳定性：确保函数调用的稳定性和可预测性","code":""},{"path":"https://hui950319.github.io/BulkS4/IMPORT_OPTIMIZATION.html","id":"id_2-代码可维护性提升","dir":"","previous_headings":"优化效果","what":"2. 代码可维护性提升","title":"R包函数Import语句优化总结","text":"清晰的依赖：开发者可以清楚地看到每个文件的依赖关系 便于调试：当出现函数调用问题时，更容易定位问题 版本兼容性：明确的import有助于处理包版本兼容性问题","code":""},{"path":"https://hui950319.github.io/BulkS4/IMPORT_OPTIMIZATION.html","id":"id_3-包开发最佳实践","dir":"","previous_headings":"优化效果","what":"3. 包开发最佳实践","title":"R包函数Import语句优化总结","text":"符合CRAN标准：遵循R包开发的最佳实践 通过检查：减少R CMD check的警告和错误 专业化：提升包的专业性和可信度","code":""},{"path":[]},{"path":"https://hui950319.github.io/BulkS4/IMPORT_OPTIMIZATION.html","id":"id_1-import语句的选择原则","dir":"","previous_headings":"技术细节","what":"1. Import语句的选择原则","title":"R包函数Import语句优化总结","text":"最小化原则：只导入实际使用的函数 明确性原则：避免使用import(package)，而是使用importFrom(package, function) 一致性原则：在整个包中保持一致的import风格","code":""},{"path":"https://hui950319.github.io/BulkS4/IMPORT_OPTIMIZATION.html","id":"id_2-常用包的import策略","dir":"","previous_headings":"技术细节","what":"2. 常用包的import策略","title":"R包函数Import语句优化总结","text":"methods包：S4类和方法定义的核心包 stats包：统计函数的标准包 utils包：实用工具函数包 cli包：现代化的命令行界面包","code":""},{"path":"https://hui950319.github.io/BulkS4/IMPORT_OPTIMIZATION.html","id":"id_3-特殊情况处理","dir":"","previous_headings":"技术细节","what":"3. 特殊情况处理","title":"R包函数Import语句优化总结","text":"条件导入：对于可选依赖，使用requireNamespace进行条件检查 内部函数：对于包内部函数，不需要import声明 基础函数：base包的函数通常不需要显式import","code":""},{"path":[]},{"path":"https://hui950319.github.io/BulkS4/IMPORT_OPTIMIZATION.html","id":"id_1-namespace验证","dir":"","previous_headings":"验证和测试","what":"1. NAMESPACE验证","title":"R包函数Import语句优化总结","text":"","code":"# 检查NAMESPACE文件的正确性 devtools::document() devtools::check()"},{"path":"https://hui950319.github.io/BulkS4/IMPORT_OPTIMIZATION.html","id":"id_2-函数调用测试","dir":"","previous_headings":"验证和测试","what":"2. 函数调用测试","title":"R包函数Import语句优化总结","text":"","code":"# 测试所有导入的函数是否正常工作 library(BulkS4) # 运行各种函数测试"},{"path":"https://hui950319.github.io/BulkS4/IMPORT_OPTIMIZATION.html","id":"id_3-依赖检查","dir":"","previous_headings":"验证和测试","what":"3. 依赖检查","title":"R包函数Import语句优化总结","text":"","code":"# 检查包的依赖关系 tools::package_dependencies(\"BulkS4\", recursive = TRUE)"},{"path":[]},{"path":"https://hui950319.github.io/BulkS4/IMPORT_OPTIMIZATION.html","id":"id_1-定期检查","dir":"","previous_headings":"未来维护建议","what":"1. 定期检查","title":"R包函数Import语句优化总结","text":"依赖更新：定期检查依赖包的更新 函数变更：关注依赖包中函数的变更 废弃警告：及时处理函数废弃警告","code":""},{"path":"https://hui950319.github.io/BulkS4/IMPORT_OPTIMIZATION.html","id":"id_2-新增函数时的注意事项","dir":"","previous_headings":"未来维护建议","what":"2. 新增函数时的注意事项","title":"R包函数Import语句优化总结","text":"立即添加import：新增使用外部函数时立即添加import声明 文档同步：确保roxygen2注释与实际使用保持同步 测试验证：新增import后进行充分测试","code":""},{"path":"https://hui950319.github.io/BulkS4/IMPORT_OPTIMIZATION.html","id":"id_3-版本兼容性","dir":"","previous_headings":"未来维护建议","what":"3. 版本兼容性","title":"R包函数Import语句优化总结","text":"最低版本要求：在DESCRIPTION中明确最低版本要求 向后兼容：考虑向后兼容性问题 替代方案：为可能废弃的函数准备替代方案","code":""},{"path":[]},{"path":"https://hui950319.github.io/BulkS4/IMPORT_OPTIMIZATION.html","id":"id_1-函数找不到错误","dir":"","previous_headings":"常见问题解决","what":"1. 函数找不到错误","title":"R包函数Import语句优化总结","text":"","code":"# 错误：could not find function \"xxx\" # 解决：添加相应的importFrom声明"},{"path":"https://hui950319.github.io/BulkS4/IMPORT_OPTIMIZATION.html","id":"id_2-命名空间冲突","dir":"","previous_headings":"常见问题解决","what":"2. 命名空间冲突","title":"R包函数Import语句优化总结","text":"","code":"# 错误：多个包中有同名函数 # 解决：使用明确的包名调用，如package::function"},{"path":"https://hui950319.github.io/BulkS4/IMPORT_OPTIMIZATION.html","id":"id_3-循环依赖","dir":"","previous_headings":"常见问题解决","what":"3. 循环依赖","title":"R包函数Import语句优化总结","text":"","code":"# 错误：包之间存在循环依赖 # 解决：重新设计包结构，避免循环依赖"},{"path":"https://hui950319.github.io/BulkS4/IMPORT_OPTIMIZATION.html","id":"总结","dir":"","previous_headings":"","what":"总结","title":"R包函数Import语句优化总结","text":"本次import优化工作： 完整性：为所有R文件添加了必要的import声明 准确性：确保每个import都对应实际使用的函数 一致性：在整个包中保持一致的import风格 可维护性：提高了代码的可维护性和可读性 标准化：符合R包开发的最佳实践和CRAN标准 这些改进使BulkS4包更加专业、稳定和易于维护，为后续的开发和扩展奠定了良好的基础。","code":""},{"path":"https://hui950319.github.io/BulkS4/index.html","id":"bulks4-s4-classes-for-bulk-rna-seq-data-analysis","dir":"","previous_headings":"","what":"BulkS4: S4 Classes for Bulk RNA-seq Data Analysis","title":"BulkS4: S4 Classes for Bulk RNA-seq Data Analysis","text":"BulkS4 comprehensive R package provides S4 classes methods bulk RNA-seq data analysis. package offers unified framework storing, analyzing, visualizing bulk RNA-seq data integrated support : 🧬 Differential Expression Analysis using DESeq2, edgeR, limma-voom 📊 Gene Set Enrichment Analysis (GSEA) 🎯 Gene Set Variation Analysis (GSVA) 📈 Rich Visualization Tools publication-ready plots 🗂️ Integrated Data Management S4 classes Find https://hui950319.github.io/BulkS4/.","code":""},{"path":"https://hui950319.github.io/BulkS4/index.html","id":"sparkles-key-features","dir":"","previous_headings":"","what":"✨ Key Features","title":"BulkS4: S4 Classes for Bulk RNA-seq Data Analysis","text":"BulkRNAseq S4 Class: Unified data structure storing raw counts, normalized data, sample metadata, analysis results Data Validation: Built-data consistency checks validation mechanisms Flexible Constructor: Support creating objects matrices preprocessed lists Rich Visualization: Complete set plotting functions expression data, heatmaps, volcano plots, MSigDB Integration: Automatic loading MSigDB gene sets (Hallmark, KEGG, Reactome, GO) Multiple DE Methods: Integrated support DESeq2, edgeR, limma-voom method comparison Gene Set Analysis: GSEA GSVA analysis capabilities multiple gene set collections","code":""},{"path":"https://hui950319.github.io/BulkS4/index.html","id":"package-installation","dir":"","previous_headings":"","what":"📦 Installation","title":"BulkS4: S4 Classes for Bulk RNA-seq Data Analysis","text":"","code":"# Install from GitHub (recommended) if (!require(\"devtools\")) install.packages(\"devtools\") devtools::install_github(\"HUI950319/BulkS4\")  # Load the package library(BulkS4)"},{"path":[]},{"path":"https://hui950319.github.io/BulkS4/index.html","id":"load-example-data","dir":"","previous_headings":"🚀 Quick Start","what":"Load Example Data","title":"BulkS4: S4 Classes for Bulk RNA-seq Data Analysis","text":"BulkS4 comes example datasets can use get started:","code":"library(BulkS4)  # Load example datasets included in the package data(counts)      # Example RNA-seq count matrix (36888 genes × 6 samples) data(metadata)    # Example sample metadata data(geneSet_msig) # MSigDB gene sets  # Examine the example data head(counts) #>          Cov1 Cov2 Cov3 Mock1 Mock2 Mock3 #> TSPAN6   1270 1013  848  4571  5500  4844 #> TNMD      121  125   49  3220  6435  2977 #> DPM1     1023 1045  674  2404  4794  1819 #> SCYL3    1049  713  692   854   356  1015 #> C1orf112  211  158   90   576   195   477 #> FGR         9    8    2    10     5     0 head(metadata) #>       sample group #> Cov1    Cov1 treat #> Cov2    Cov2 treat #> Cov3    Cov3 treat #> Mock1  Mock1   con #> Mock2  Mock2   con #> Mock3  Mock3   con"},{"path":"https://hui950319.github.io/BulkS4/index.html","id":"create-bulkrnaseq-object","dir":"","previous_headings":"🚀 Quick Start","what":"Create BulkRNAseq Object","title":"BulkS4: S4 Classes for Bulk RNA-seq Data Analysis","text":"","code":"# Create BulkRNAseq object from example data bulk_obj <- BulkRNAseq(counts, metadata)  # View object summary bulk_obj                      #>  #>  ====== BulkRNAseq Object ======  #>  #> Genes:          36888 #> Samples:        6 #> Metadata vars:  sample, group #>  #>  ------ Analysis Results ------  #>  #> Diff analyses:  0: None #> Gene sets:      25: C1, C2_CGP, C2_CP, C2_CP:BIOCARTA, C2_CP:KEGG_LEGACY, C2_CP:KEGG_MEDICUS, C2_CP:PID, C2_CP:REACTOME, C2_CP:WIKIPATHWAYS, C3_MIR:MIRDB, C3_MIR:MIR_LEGACY, C3_TFT:GTRD, C3_TFT:TFT_LEGACY, C4_3CA, C4_CGN, C4_CM, C5_GO:BP, C5_GO:CC, C5_GO:MF, C5_HPO, C6, C7_IMMUNESIGDB, C7_VAX, C8, H #> GSEA results:   0: None #> GSVA results:   0: None #>  #>  --------------------------------------------------"},{"path":[]},{"path":"https://hui950319.github.io/BulkS4/index.html","id":"run-differential-analysis","dir":"","previous_headings":"🔬 Differential Expression Analysis","what":"Run Differential Analysis","title":"BulkS4: S4 Classes for Bulk RNA-seq Data Analysis","text":"","code":"# Run differential expression analysis using DESeq2--add normalized data and diff results bulk_obj <- runDiffAnalysis(bulk_obj, method = \"DESeq2\") # View the updated object bulk_obj    # View the updated object  # Get differential expression results diff_results <- getDiffResults(bulk_obj) head(diff_results[[1]])"},{"path":"https://hui950319.github.io/BulkS4/index.html","id":"bar_chart-visualization-examples","dir":"","previous_headings":"","what":"📊 Visualization Examples","title":"BulkS4: S4 Classes for Bulk RNA-seq Data Analysis","text":"BulkS4 provides comprehensive visualization functions RNA-seq data analysis:","code":""},{"path":"https://hui950319.github.io/BulkS4/index.html","id":"gene-expression-barbox-plots","dir":"","previous_headings":"📊 Visualization Examples","what":"Gene Expression Bar/Box Plots","title":"BulkS4: S4 Classes for Bulk RNA-seq Data Analysis","text":"","code":"# Single gene expression bar(bulk_obj, genes = \"CD36\", group = \"group\") # Multiple genes expression bar(bulk_obj, genes = c(\"CD36\", \"GAPDH\", \"ACTB\"), group = \"group\")"},{"path":"https://hui950319.github.io/BulkS4/index.html","id":"heatmaps","dir":"","previous_headings":"📊 Visualization Examples","what":"Heatmaps","title":"BulkS4: S4 Classes for Bulk RNA-seq Data Analysis","text":"","code":"# Heatmap of specific genes selected_genes <-c(\"TSPAN6\", \"TNMD\", \"DPM1\", \"SCYL3\", \"C1orf112\", \"FGR\", \"CFH\") hmap(bulk_obj, genes = selected_genes) # Heatmap of top 20 DEGs bulk_obj <- runDiffAnalysis(bulk_obj, method = \"DESeq2\") hmap(bulk_obj, genes = 20)"},{"path":"https://hui950319.github.io/BulkS4/index.html","id":"pca-and-hierarchical-clustering","dir":"","previous_headings":"📊 Visualization Examples","what":"PCA and Hierarchical Clustering","title":"BulkS4: S4 Classes for Bulk RNA-seq Data Analysis","text":"","code":"# PCA and hierarchical clustering combined plot # Note: This requires additional packages (factoextra, tinyarray, ggsci, patchwork) pca_hc(bulk_obj)"},{"path":"https://hui950319.github.io/BulkS4/index.html","id":"volcano-plot","dir":"","previous_headings":"📊 Visualization Examples","what":"Volcano Plot","title":"BulkS4: S4 Classes for Bulk RNA-seq Data Analysis","text":"","code":"# Create volcano plot for differential expression results bulk_obj <- runDiffAnalysis(bulk_obj, method = \"DESeq2\") volcano(bulk_obj, data = \"DESeq2_treat_vs_con\")"},{"path":"https://hui950319.github.io/BulkS4/index.html","id":"ma-plot","dir":"","previous_headings":"📊 Visualization Examples","what":"MA Plot","title":"BulkS4: S4 Classes for Bulk RNA-seq Data Analysis","text":"","code":"# Create MA plot bulk_obj <- runDiffAnalysis(bulk_obj, method = \"DESeq2\") MA(bulk_obj, data = \"DESeq2_treat_vs_con\")"},{"path":[]},{"path":"https://hui950319.github.io/BulkS4/index.html","id":"gene-set-enrichment-analysis-gsea","dir":"","previous_headings":"🎯 Gene Set Analysis","what":"Gene Set Enrichment Analysis (GSEA)","title":"BulkS4: S4 Classes for Bulk RNA-seq Data Analysis","text":"","code":"# Run GSEA analysis-- use genesets from MSigDB bulk_obj <- gsea(bulk_obj, geneSet_name = \"H\" )  # # Run GSEA analysis with common used genesets # bulk_obj <- gsea(bulk_obj, geneSet_name = c(\"H\", \"C2_CP:KEGG_LEGACY\", \"C5_GO:BP\", \"C5_GO:CC\", \"C5_GO:MF\") )  # View bulk_obj--gsea results add to gsea slot bulk_obj #>  #>  ====== BulkRNAseq Object ======  #>  #> Genes:          36888 #> Samples:        6 #> Metadata vars:  sample, group #>  #>  ------ Analysis Results ------  #>  #> Diff analyses:  1: DESeq2_treat_vs_con #> Gene sets:      25: C1, C2_CGP, C2_CP, C2_CP:BIOCARTA, C2_CP:KEGG_LEGACY, C2_CP:KEGG_MEDICUS, C2_CP:PID, C2_CP:REACTOME, C2_CP:WIKIPATHWAYS, C3_MIR:MIRDB, C3_MIR:MIR_LEGACY, C3_TFT:GTRD, C3_TFT:TFT_LEGACY, C4_3CA, C4_CGN, C4_CM, C5_GO:BP, C5_GO:CC, C5_GO:MF, C5_HPO, C6, C7_IMMUNESIGDB, C7_VAX, C8, H #> GSEA results:   1: H #> GSVA results:   0: None #>  #>  -------------------------------------------------- # head(bulk_obj@gsea$H)  # Visualize GSEA results clusterProfiler::dotplot(bulk_obj@gsea$H, split = \".sign\", label_format = 60) + ggplot2::facet_grid(~.sign)"},{"path":"https://hui950319.github.io/BulkS4/index.html","id":"gene-set-variation-analysis-gsva","dir":"","previous_headings":"🎯 Gene Set Analysis","what":"Gene Set Variation Analysis (GSVA)","title":"BulkS4: S4 Classes for Bulk RNA-seq Data Analysis","text":"","code":"# Run GSVA analysis -- add gsva results and diff results of gsva results bulk_obj <- gsva(bulk_obj, geneSet_name = \"H\")  # # Run GSVA analysis with common used genesets # bulk_obj <- gsva(bulk_obj, geneSet_name = c(\"H\", \"C2_CP:KEGG_LEGACY\", \"C5_GO:BP\", \"C5_GO:CC\", \"C5_GO:MF\") )  # View bulk_obj--gsva results add to gsva slot bulk_obj #>  #>  ====== BulkRNAseq Object ======  #>  #> Genes:          36888 #> Samples:        6 #> Metadata vars:  sample, group #>  #>  ------ Analysis Results ------  #>  #> Diff analyses:  2: DESeq2_treat_vs_con, H #> Gene sets:      25: C1, C2_CGP, C2_CP, C2_CP:BIOCARTA, C2_CP:KEGG_LEGACY, C2_CP:KEGG_MEDICUS, C2_CP:PID, C2_CP:REACTOME, C2_CP:WIKIPATHWAYS, C3_MIR:MIRDB, C3_MIR:MIR_LEGACY, C3_TFT:GTRD, C3_TFT:TFT_LEGACY, C4_3CA, C4_CGN, C4_CM, C5_GO:BP, C5_GO:CC, C5_GO:MF, C5_HPO, C6, C7_IMMUNESIGDB, C7_VAX, C8, H #> GSEA results:   1: H #> GSVA results:   1: H #>  #>  -------------------------------------------------- # head(bulk_obj@gsva$H)  # Visualize GSVA results # Bar plot bar(bulk_obj, genes = \"HALLMARK_INFLAMMATORY_RESPONSE\", data = \"H\") # Heatmap hmap(bulk_obj, data = \"H\", genes = 20) # Volcano plot volcano(bulk_obj, data = \"H\") # MA plot MA(bulk_obj, data = \"H\")"},{"path":"https://hui950319.github.io/BulkS4/index.html","id":"books-documentation","dir":"","previous_headings":"","what":"📚 Documentation","title":"BulkS4: S4 Classes for Bulk RNA-seq Data Analysis","text":"detailed tutorials examples, please visit documentation website: Getting Started Guide Differential Expression Analysis Visualization Tutorial Function Reference","code":""},{"path":"https://hui950319.github.io/BulkS4/index.html","id":"handshake-contributing","dir":"","previous_headings":"","what":"🤝 Contributing","title":"BulkS4: S4 Classes for Bulk RNA-seq Data Analysis","text":"welcome contributions! Please see Contributing Guidelines details.","code":""},{"path":"https://hui950319.github.io/BulkS4/index.html","id":"page_facing_up-license","dir":"","previous_headings":"","what":"📄 License","title":"BulkS4: S4 Classes for Bulk RNA-seq Data Analysis","text":"project licensed MIT License - see LICENSE file details.","code":""},{"path":"https://hui950319.github.io/BulkS4/index.html","id":"telephone_receiver-contact","dir":"","previous_headings":"","what":"📞 Contact","title":"BulkS4: S4 Classes for Bulk RNA-seq Data Analysis","text":"Author: Hui Ouyang Email: [-email@example.com] GitHub: @HUI950319 Issues: GitHub Issues","code":""},{"path":"https://hui950319.github.io/BulkS4/index.html","id":"open_book-citation","dir":"","previous_headings":"","what":"📖 Citation","title":"BulkS4: S4 Classes for Bulk RNA-seq Data Analysis","text":"use BulkS4 research, please cite:","code":"Ouyang, H. (2024). BulkS4: S4 Classes for Bulk RNA-seq Data Analysis.  R package version 0.1.1. https://github.com/HUI950319/BulkS4"},{"path":"https://hui950319.github.io/BulkS4/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2025 BulkS4 authors Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":[]},{"path":"https://hui950319.github.io/BulkS4/OPTIMIZATION_SUMMARY.html","id":"优化概述","dir":"","previous_headings":"","what":"优化概述","title":"BulkS4 包优化总结","text":"本次优化将原始的单文件R包重构为符合R包开发最佳实践的结构化包，解决了所有R CMD check的错误和警告。","code":""},{"path":[]},{"path":"https://hui950319.github.io/BulkS4/OPTIMIZATION_SUMMARY.html","id":"id_1-代码结构重组","dir":"","previous_headings":"主要改进","what":"1. 代码结构重组","title":"BulkS4 包优化总结","text":"之前: 所有代码都在一个文件中 (R/S4class_def.R) 之后: 按功能分离到多个文件 - R/S4class_def.R: S4类定义和构造函数 - R/methods.R: S4方法定义 - R/utils.R: 实用函数","code":""},{"path":"https://hui950319.github.io/BulkS4/OPTIMIZATION_SUMMARY.html","id":"id_2-文档改进","dir":"","previous_headings":"主要改进","what":"2. 文档改进","title":"BulkS4 包优化总结","text":"所有函数都有详细的参数说明 包含使用示例 添加了返回值说明 包含安装说明 详细的使用示例 最佳实践指南","code":""},{"path":"https://hui950319.github.io/BulkS4/OPTIMIZATION_SUMMARY.html","id":"id_3-包元数据优化","dir":"","previous_headings":"主要改进","what":"3. 包元数据优化","title":"BulkS4 包优化总结","text":"DESCRIPTION文件改进: - 更新了包描述和标题 - 正确配置了依赖关系 - 修复了许可证格式 - 移除了不必要的VignetteBuilder NAMESPACE文件优化: - 使用精确的导入而不是exportPattern - 正确导入methods和cli包 - 明确导出所有公共函数和方法","code":""},{"path":"https://hui950319.github.io/BulkS4/OPTIMIZATION_SUMMARY.html","id":"id_4-代码质量提升","dir":"","previous_headings":"主要改进","what":"4. 代码质量提升","title":"BulkS4 包优化总结","text":"输入验证增强: - 添加了S4类的validity函数 - 改进了错误消息的清晰度 - 使用辅助函数减少代码重复 错误处理改进: - 统一的错误消息格式 - 更好的异常处理机制 - 使用call. = FALSE避免显示调用栈","code":""},{"path":"https://hui950319.github.io/BulkS4/OPTIMIZATION_SUMMARY.html","id":"id_5-国际化支持","dir":"","previous_headings":"主要改进","what":"5. 国际化支持","title":"BulkS4 包优化总结","text":"ASCII兼容性: - 将所有中文字符转换为Unicode转义序列 - 确保包符合CRAN的ASCII要求 - 保持了中文显示的功能","code":""},{"path":"https://hui950319.github.io/BulkS4/OPTIMIZATION_SUMMARY.html","id":"id_6-新增功能","dir":"","previous_headings":"主要改进","what":"6. 新增功能","title":"BulkS4 包优化总结","text":"实用函数: - getCounts(): 获取原始计数矩阵 - getData(): 获取标准化数据矩阵 - getMetadata(): 获取元数据 - getDiffResults(): 获取差异分析结果 - getGeneSets(): 获取基因集 - setData(): 设置标准化数据 - addDiffResults(): 添加差异分析结果 - summary.BulkRNAseq(): 详细摘要信息 S4方法增强: - dim(): 获取矩阵维度 - rownames()/colnames(): 获取行名和列名 - [: 子集化操作 - 改进的show()方法，显示更丰富的信息","code":""},{"path":"https://hui950319.github.io/BulkS4/OPTIMIZATION_SUMMARY.html","id":"id_7-解决的r-cmd-check问题","dir":"","previous_headings":"主要改进","what":"7. 解决的R CMD check问题","title":"BulkS4 包优化总结","text":"ERROR: 移除了不存在的hello()函数引用 WARNING: 修复了非ASCII字符问题 WARNING: 修复了S3方法参数一致性问题 WARNING: 移除了不存在的文档引用 NOTE: 修复了NAMESPACE导入问题 NOTE: 修复了许可证格式问题 NOTE: 移除了不必要的依赖","code":""},{"path":"https://hui950319.github.io/BulkS4/OPTIMIZATION_SUMMARY.html","id":"文件结构","dir":"","previous_headings":"","what":"文件结构","title":"BulkS4 包优化总结","text":"","code":"BulkS4/ ├── DESCRIPTION          # 包元数据 ├── NAMESPACE           # 导出控制 ├── LICENSE             # MIT许可证 ├── README.md           # 使用说明 ├── R/ │   ├── S4class_def.R   # S4类定义和构造函数 │   ├── methods.R       # S4方法定义 │   └── utils.R         # 实用函数 ├── man/                # 自动生成的文档 └── test_package.R      # 测试脚本"},{"path":"https://hui950319.github.io/BulkS4/OPTIMIZATION_SUMMARY.html","id":"使用示例","dir":"","previous_headings":"","what":"使用示例","title":"BulkS4 包优化总结","text":"","code":"library(BulkS4)  # 创建测试数据 counts_mat <- matrix(rpois(1000, 10), nrow = 100, ncol = 10) rownames(counts_mat) <- paste0(\"Gene\", 1:100) colnames(counts_mat) <- paste0(\"Sample\", 1:10)  metadata <- data.frame(   condition = rep(c(\"Control\", \"Treatment\"), each = 5),   row.names = colnames(counts_mat) )  # 创建BulkRNAseq对象 bulk_obj <- BulkRNAseq(counts_mat, metadata)  # 基本操作 print(bulk_obj) dim(bulk_obj) bulk_obj$condition  # 数据访问 counts <- getCounts(bulk_obj) metadata <- getMetadata(bulk_obj)  # 子集化 subset_obj <- bulk_obj[1:50, 1:5]"},{"path":"https://hui950319.github.io/BulkS4/OPTIMIZATION_SUMMARY.html","id":"最佳实践遵循","dir":"","previous_headings":"","what":"最佳实践遵循","title":"BulkS4 包优化总结","text":"代码组织: 按功能分离文件 文档: 完整的roxygen2文档 测试: 包含基本功能测试 依赖管理: 明确的导入声明 错误处理: 清晰的错误消息 国际化: ASCII兼容的代码 版本控制: 适当的.gitignore和.Rbuildignore","code":""},{"path":"https://hui950319.github.io/BulkS4/OPTIMIZATION_SUMMARY.html","id":"下一步建议","dir":"","previous_headings":"","what":"下一步建议","title":"BulkS4 包优化总结","text":"添加单元测试 (testthat) 创建vignettes文档 添加更多分析功能 考虑发布到CRAN 添加持续集成 (GitHub Actions) 这次优化使BulkS4包从一个简单的脚本转变为一个专业的、符合R包开发标准的包，为后续的功能扩展和维护奠定了坚实的基础。","code":""},{"path":"https://hui950319.github.io/BulkS4/reference/addDiffResults.html","id":null,"dir":"Reference","previous_headings":"","what":"Add Differential Analysis Results — addDiffResults","title":"Add Differential Analysis Results — addDiffResults","text":"Add differential analysis results BulkRNAseq object","code":""},{"path":"https://hui950319.github.io/BulkS4/reference/addDiffResults.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Add Differential Analysis Results — addDiffResults","text":"","code":"addDiffResults(object, results, name)"},{"path":"https://hui950319.github.io/BulkS4/reference/addDiffResults.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Add Differential Analysis Results — addDiffResults","text":"object BulkRNAseq object results Data.frame list differential analysis results name Character. Name differential analysis results","code":""},{"path":"https://hui950319.github.io/BulkS4/reference/addDiffResults.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Add Differential Analysis Results — addDiffResults","text":"Updated BulkRNAseq object","code":""},{"path":"https://hui950319.github.io/BulkS4/reference/bar.html","id":null,"dir":"Reference","previous_headings":"","what":"Bar Plots for Gene Expression — bar","title":"Bar Plots for Gene Expression — bar","text":"Create bar box plots gene expression data BulkRNAseq objects.","code":""},{"path":"https://hui950319.github.io/BulkS4/reference/bar.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Bar Plots for Gene Expression — bar","text":"","code":"bar(   object,   data = \"data\",   genes = \"CD36\",   group = \"group\",   palette = c(\"#00AFBB\", \"#E7B800\"),   method = \"t.test\" )  # S4 method for class 'BulkRNAseq' bar(   object,   data = \"data\",   genes = \"CD36\",   group = \"group\",   palette = c(\"#00AFBB\", \"#E7B800\"),   method = \"t.test\" )"},{"path":"https://hui950319.github.io/BulkS4/reference/bar.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Bar Plots for Gene Expression — bar","text":"object BulkRNAseq object data Character, data source expression data name gsva result genes Character vector, gene names plot group Character, column name metadata grouping palette Character vector, colors groups method Character, statistical test method comparison","code":""},{"path":"https://hui950319.github.io/BulkS4/reference/bar.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Bar Plots for Gene Expression — bar","text":"ggplot object","code":""},{"path":"https://hui950319.github.io/BulkS4/reference/bar.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Bar Plots for Gene Expression — bar","text":"","code":"if (FALSE) { # \\dontrun{ data(counts) data(metadata) bulk_obj <- BulkRNAseq(counts, metadata) bar(bulk_obj, genes = \"CD36\") bar(bulk_obj, genes = c(\"CD36\", \"GAPDH\")) } # }"},{"path":"https://hui950319.github.io/BulkS4/reference/BulkRNAseq-class.html","id":null,"dir":"Reference","previous_headings":"","what":"BulkRNAseq S4 Class — BulkRNAseq-class","title":"BulkRNAseq S4 Class — BulkRNAseq-class","text":"S4 class storing analyzing bulk RNA-seq data","code":""},{"path":"https://hui950319.github.io/BulkS4/reference/BulkRNAseq-class.html","id":"slots","dir":"Reference","previous_headings":"","what":"Slots","title":"BulkRNAseq S4 Class — BulkRNAseq-class","text":"counts matrix. Raw count matrix (genes x samples) data matrix. Normalized data matrix (genes x samples) metadata data.frame. Sample metadata (rownames sample names) allDiff list. Differential analysis results (list data.frames) geneSet list. Gene sets GSEA/GSVA analysis (multiple data.frames) gsea list. GSEA/enrichment analysis results (data.frames) gsva list. GSVA/ssGSEA analysis results (pathways x samples data.frames)","code":""},{"path":"https://hui950319.github.io/BulkS4/reference/BulkRNAseq.html","id":null,"dir":"Reference","previous_headings":"","what":"Create BulkRNAseq Object — BulkRNAseq","title":"Create BulkRNAseq Object — BulkRNAseq","text":"Constructor function BulkRNAseq S4 objects","code":""},{"path":"https://hui950319.github.io/BulkS4/reference/BulkRNAseq.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create BulkRNAseq Object — BulkRNAseq","text":"","code":"BulkRNAseq(counts, metadata = NULL, add_msig.geneSet = TRUE)"},{"path":"https://hui950319.github.io/BulkS4/reference/BulkRNAseq.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create BulkRNAseq Object — BulkRNAseq","text":"counts matrix data.frame raw counts, list containing required fields (counts, metadata, exprSet, allDiff) metadata data.frame sample metadata. NULL, empty data.frame created add_msig.geneSet Logical. Whether add MSigDB gene sets object","code":""},{"path":"https://hui950319.github.io/BulkS4/reference/BulkRNAseq.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create BulkRNAseq Object — BulkRNAseq","text":"BulkRNAseq S4 object","code":""},{"path":"https://hui950319.github.io/BulkS4/reference/BulkRNAseq.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Create BulkRNAseq Object — BulkRNAseq","text":"","code":"# Create from matrix counts_mat <- matrix(rpois(1000, 10), nrow = 100, ncol = 10) rownames(counts_mat) <- paste0(\"Gene\", 1:100) colnames(counts_mat) <- paste0(\"Sample\", 1:10)  metadata <- data.frame(   condition = rep(c(\"Control\", \"Treatment\"), each = 5),   row.names = colnames(counts_mat) )  bulk_obj <- BulkRNAseq(counts_mat, metadata) #> Successfully loaded MSigDB gene sets from package data"},{"path":"https://hui950319.github.io/BulkS4/reference/cash-BulkRNAseq-method.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract Metadata Columns — $,BulkRNAseq-method","title":"Extract Metadata Columns — $,BulkRNAseq-method","text":"Extract columns metadata using $ operator","code":""},{"path":"https://hui950319.github.io/BulkS4/reference/cash-BulkRNAseq-method.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract Metadata Columns — $,BulkRNAseq-method","text":"","code":"# S4 method for class 'BulkRNAseq' x$name"},{"path":"https://hui950319.github.io/BulkS4/reference/cash-BulkRNAseq-method.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract Metadata Columns — $,BulkRNAseq-method","text":"x BulkRNAseq object name Character. Column name metadata","code":""},{"path":"https://hui950319.github.io/BulkS4/reference/cash-BulkRNAseq-method.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extract Metadata Columns — $,BulkRNAseq-method","text":"Vector values specified metadata column","code":""},{"path":"https://hui950319.github.io/BulkS4/reference/cash-BulkRNAseq-method.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Extract Metadata Columns — $,BulkRNAseq-method","text":"","code":"# Assuming bulk_obj is a BulkRNAseq object with metadata # bulk_obj$condition  # Extract condition column"},{"path":"https://hui950319.github.io/BulkS4/reference/colnames-BulkRNAseq-method.html","id":null,"dir":"Reference","previous_headings":"","what":"Get Column Names — colnames,BulkRNAseq-method","title":"Get Column Names — colnames,BulkRNAseq-method","text":"Get sample names (column names count matrix)","code":""},{"path":"https://hui950319.github.io/BulkS4/reference/colnames-BulkRNAseq-method.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get Column Names — colnames,BulkRNAseq-method","text":"","code":"# S4 method for class 'BulkRNAseq' colnames(x)"},{"path":"https://hui950319.github.io/BulkS4/reference/colnames-BulkRNAseq-method.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get Column Names — colnames,BulkRNAseq-method","text":"x BulkRNAseq object","code":""},{"path":"https://hui950319.github.io/BulkS4/reference/colnames-BulkRNAseq-method.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get Column Names — colnames,BulkRNAseq-method","text":"Character vector sample names","code":""},{"path":"https://hui950319.github.io/BulkS4/reference/compareDiffMethods.html","id":null,"dir":"Reference","previous_headings":"","what":"Compare Multiple Differential Expression Methods — compareDiffMethods","title":"Compare Multiple Differential Expression Methods — compareDiffMethods","text":"Run multiple differential expression methods compare results","code":""},{"path":"https://hui950319.github.io/BulkS4/reference/compareDiffMethods.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compare Multiple Differential Expression Methods — compareDiffMethods","text":"","code":"compareDiffMethods(   object,   methods = c(\"DESeq2\", \"edgeR\", \"limma_voom\"),   group_col = \"group\",   treat_level = \"treat\",   control_level = \"con\",   fc_cutoff = 1,   padj_cutoff = 0.05,   plot_comparison = TRUE )"},{"path":"https://hui950319.github.io/BulkS4/reference/compareDiffMethods.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compare Multiple Differential Expression Methods — compareDiffMethods","text":"object BulkRNAseq object methods Character vector, methods compare: \"DESeq2\", \"edgeR\", \"limma_voom\" group_col Character, column name metadata grouping treat_level Character, treatment level name control_level Character, control level name fc_cutoff Numeric, log2 fold change threshold padj_cutoff Numeric, adjusted p-value threshold plot_comparison Logical, whether create comparison plots","code":""},{"path":"https://hui950319.github.io/BulkS4/reference/compareDiffMethods.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compare Multiple Differential Expression Methods — compareDiffMethods","text":"Updated BulkRNAseq object analysis results","code":""},{"path":"https://hui950319.github.io/BulkS4/reference/compareDiffMethods.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Compare Multiple Differential Expression Methods — compareDiffMethods","text":"","code":"if (FALSE) { # \\dontrun{ bulk_obj <- compareDiffMethods(bulk_obj,                               methods = c(\"DESeq2\", \"edgeR\", \"limma_voom\")) } # }"},{"path":"https://hui950319.github.io/BulkS4/reference/convert_genes.html","id":null,"dir":"Reference","previous_headings":"","what":"Convert Gene IDs in Expression Matrix — convert_genes","title":"Convert Gene IDs in Expression Matrix — convert_genes","text":"Convert gene IDs expression matrix using clusterProfiler biomaRt","code":""},{"path":"https://hui950319.github.io/BulkS4/reference/convert_genes.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Convert Gene IDs in Expression Matrix — convert_genes","text":"","code":"convert_genes(   expr_matrix,   from_type = \"ENSEMBL\",   to_type = \"SYMBOL\",   OrgDb = \"org.Hs.eg.db\",   use_biomart = FALSE,   biomart_dataset = \"hsapiens_gene_ensembl\",   gene_to_rownames = TRUE )"},{"path":"https://hui950319.github.io/BulkS4/reference/convert_genes.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Convert Gene IDs in Expression Matrix — convert_genes","text":"expr_matrix Gene expression matrix gene IDs rownames from_type Source ID type (e.g., \"ENSEMBL\", \"ENTREZID\", \"SYMBOL\") to_type Target ID type (e.g., \"SYMBOL\", \"ENTREZID\", \"ENSEMBL\") OrgDb Annotation database use, default \"org.Hs.eg.db\" use_biomart Whether use biomaRt conversion, default FALSE biomart_dataset biomaRt dataset name, default \"hsapiens_gene_ensembl\" gene_to_rownames Whether convert gene ID column rownames","code":""},{"path":"https://hui950319.github.io/BulkS4/reference/convert_genes.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Convert Gene IDs in Expression Matrix — convert_genes","text":"Expression matrix converted gene IDs","code":""},{"path":"https://hui950319.github.io/BulkS4/reference/convert_genes.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Convert Gene IDs in Expression Matrix — convert_genes","text":"","code":"if (FALSE) { # \\dontrun{ # Create example expression matrix expr_matrix <- matrix(rpois(60, 10), nrow = 6, ncol = 10) rownames(expr_matrix) <- c(\"ENSG00000223972\", \"ENSG00000227232\",                           \"ENSG00000278267\", \"ENSG00000243485\",                           \"ENSG00000284332\", \"ENSG00000237613\") colnames(expr_matrix) <- paste0(\"Sample\", 1:10)  # Convert using clusterProfiler convert_genes(expr_matrix) } # }"},{"path":"https://hui950319.github.io/BulkS4/reference/dedup_genes.html","id":null,"dir":"Reference","previous_headings":"","what":"Remove Duplicate Genes from Expression Matrix — dedup_genes","title":"Remove Duplicate Genes from Expression Matrix — dedup_genes","text":"Remove duplicate gene IDs expression matrix using various strategies","code":""},{"path":"https://hui950319.github.io/BulkS4/reference/dedup_genes.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Remove Duplicate Genes from Expression Matrix — dedup_genes","text":"","code":"dedup_genes(   df,   gene_col = \"gene_id\",   method = c(\"first\", \"max_mean\", \"mean\", \"max_variance\"),   gene_to_rownames = TRUE )"},{"path":"https://hui950319.github.io/BulkS4/reference/dedup_genes.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Remove Duplicate Genes from Expression Matrix — dedup_genes","text":"df Data frame tibble containing gene expression data gene_col Character, column name containing gene IDs, default \"gene_id\" method Character, method handling duplicate genes: \"first\": Keep first occurrence gene ID \"max_mean\": Keep row highest mean expression \"mean\": Take average rows gene ID \"max_variance\": Keep row highest expression variance gene_to_rownames Logical, whether convert gene ID column rownames","code":""},{"path":"https://hui950319.github.io/BulkS4/reference/dedup_genes.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Remove Duplicate Genes from Expression Matrix — dedup_genes","text":"Data frame deduplicated gene expression data","code":""},{"path":"https://hui950319.github.io/BulkS4/reference/dedup_genes.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Remove Duplicate Genes from Expression Matrix — dedup_genes","text":"","code":"# Create example data df <- data.frame(   gene_id = c(\"GeneA\", \"GeneB\", \"GeneA\", \"GeneC\"),   sample1 = c(5.2, 3.1, 4.8, 1.0),   sample2 = c(6.3, 2.9, 5.7, 3.2),   sample3 = c(2.0, 2.5, 3.9, 2.8) )  # Remove duplicates using different methods dedup_genes(df, method = \"first\") #>       sample1 sample2 sample3 #> GeneA     5.2     6.3     2.0 #> GeneB     3.1     2.9     2.5 #> GeneC     1.0     3.2     2.8 dedup_genes(df, method = \"max_mean\") #>       sample1 sample2 sample3 #> GeneA     4.8     5.7     3.9 #> GeneB     3.1     2.9     2.5 #> GeneC     1.0     3.2     2.8"},{"path":"https://hui950319.github.io/BulkS4/reference/dim-BulkRNAseq-method.html","id":null,"dir":"Reference","previous_headings":"","what":"Get Dimensions — dim,BulkRNAseq-method","title":"Get Dimensions — dim,BulkRNAseq-method","text":"Get dimensions count matrix","code":""},{"path":"https://hui950319.github.io/BulkS4/reference/dim-BulkRNAseq-method.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get Dimensions — dim,BulkRNAseq-method","text":"","code":"# S4 method for class 'BulkRNAseq' dim(x)"},{"path":"https://hui950319.github.io/BulkS4/reference/dim-BulkRNAseq-method.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get Dimensions — dim,BulkRNAseq-method","text":"x BulkRNAseq object","code":""},{"path":"https://hui950319.github.io/BulkS4/reference/dim-BulkRNAseq-method.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get Dimensions — dim,BulkRNAseq-method","text":"Integer vector length 2 (nrow, ncol)","code":""},{"path":"https://hui950319.github.io/BulkS4/reference/dot-add_msigdb_genesets.html","id":null,"dir":"Reference","previous_headings":"","what":"Add MSigDB Gene Sets — .add_msigdb_genesets","title":"Add MSigDB Gene Sets — .add_msigdb_genesets","text":"Internal function add MSigDB gene sets BulkRNAseq object","code":""},{"path":"https://hui950319.github.io/BulkS4/reference/dot-add_msigdb_genesets.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Add MSigDB Gene Sets — .add_msigdb_genesets","text":"","code":".add_msigdb_genesets(object)"},{"path":"https://hui950319.github.io/BulkS4/reference/dot-add_msigdb_genesets.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Add MSigDB Gene Sets — .add_msigdb_genesets","text":"object BulkRNAseq object","code":""},{"path":"https://hui950319.github.io/BulkS4/reference/dot-add_msigdb_genesets.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Add MSigDB Gene Sets — .add_msigdb_genesets","text":"BulkRNAseq object gene sets added","code":""},{"path":"https://hui950319.github.io/BulkS4/reference/extractDiffResults.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract Differential Expression Results — extractDiffResults","title":"Extract Differential Expression Results — extractDiffResults","text":"Extract differential expression results BulkRNAseq object","code":""},{"path":"https://hui950319.github.io/BulkS4/reference/extractDiffResults.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract Differential Expression Results — extractDiffResults","text":"","code":"extractDiffResults(   object,   analysis_name,   significant_only = FALSE,   fc_cutoff = 1,   padj_cutoff = 0.05 )"},{"path":"https://hui950319.github.io/BulkS4/reference/extractDiffResults.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract Differential Expression Results — extractDiffResults","text":"object BulkRNAseq object analysis_name Character, name analysis result extract significant_only Logical, whether return significant genes fc_cutoff Numeric, fold change cutoff significance padj_cutoff Numeric, adjusted p-value cutoff significance","code":""},{"path":"https://hui950319.github.io/BulkS4/reference/extractDiffResults.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extract Differential Expression Results — extractDiffResults","text":"Data frame differential expression results","code":""},{"path":"https://hui950319.github.io/BulkS4/reference/extractDiffResults.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Extract Differential Expression Results — extractDiffResults","text":"","code":"if (FALSE) { # \\dontrun{ # Get all results all_results <- extractDiffResults(bulk_obj, \"DESeq2_treat_vs_con\")  # Get only significant results sig_results <- extractDiffResults(bulk_obj, \"DESeq2_treat_vs_con\",                                  significant_only = TRUE) } # }"},{"path":"https://hui950319.github.io/BulkS4/reference/getAnalysisSummary.html","id":null,"dir":"Reference","previous_headings":"","what":"Get Analysis Summary — getAnalysisSummary","title":"Get Analysis Summary — getAnalysisSummary","text":"Get summary differential expression analyses BulkRNAseq object","code":""},{"path":"https://hui950319.github.io/BulkS4/reference/getAnalysisSummary.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get Analysis Summary — getAnalysisSummary","text":"","code":"getAnalysisSummary(object, fc_cutoff = 1, padj_cutoff = 0.05)"},{"path":"https://hui950319.github.io/BulkS4/reference/getAnalysisSummary.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get Analysis Summary — getAnalysisSummary","text":"object BulkRNAseq object fc_cutoff Numeric, fold change cutoff counting significant genes padj_cutoff Numeric, adjusted p-value cutoff counting significant genes","code":""},{"path":"https://hui950319.github.io/BulkS4/reference/getAnalysisSummary.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get Analysis Summary — getAnalysisSummary","text":"Data frame analysis summary","code":""},{"path":"https://hui950319.github.io/BulkS4/reference/getAnalysisSummary.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get Analysis Summary — getAnalysisSummary","text":"","code":"if (FALSE) { # \\dontrun{ summary_df <- getAnalysisSummary(bulk_obj) print(summary_df) } # }"},{"path":"https://hui950319.github.io/BulkS4/reference/getCounts.html","id":null,"dir":"Reference","previous_headings":"","what":"Get Counts Matrix — getCounts","title":"Get Counts Matrix — getCounts","text":"Extract raw counts matrix BulkRNAseq object","code":""},{"path":"https://hui950319.github.io/BulkS4/reference/getCounts.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get Counts Matrix — getCounts","text":"","code":"getCounts(object)"},{"path":"https://hui950319.github.io/BulkS4/reference/getCounts.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get Counts Matrix — getCounts","text":"object BulkRNAseq object","code":""},{"path":"https://hui950319.github.io/BulkS4/reference/getCounts.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get Counts Matrix — getCounts","text":"Matrix raw counts","code":""},{"path":"https://hui950319.github.io/BulkS4/reference/getData.html","id":null,"dir":"Reference","previous_headings":"","what":"Get Normalized Data Matrix — getData","title":"Get Normalized Data Matrix — getData","text":"Extract normalized data matrix BulkRNAseq object","code":""},{"path":"https://hui950319.github.io/BulkS4/reference/getData.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get Normalized Data Matrix — getData","text":"","code":"getData(object)"},{"path":"https://hui950319.github.io/BulkS4/reference/getData.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get Normalized Data Matrix — getData","text":"object BulkRNAseq object","code":""},{"path":"https://hui950319.github.io/BulkS4/reference/getData.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get Normalized Data Matrix — getData","text":"Matrix normalized data","code":""},{"path":"https://hui950319.github.io/BulkS4/reference/getDiffResults.html","id":null,"dir":"Reference","previous_headings":"","what":"Get Differential Analysis Results — getDiffResults","title":"Get Differential Analysis Results — getDiffResults","text":"Extract differential analysis results BulkRNAseq object","code":""},{"path":"https://hui950319.github.io/BulkS4/reference/getDiffResults.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get Differential Analysis Results — getDiffResults","text":"","code":"getDiffResults(object, name = NULL)"},{"path":"https://hui950319.github.io/BulkS4/reference/getDiffResults.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get Differential Analysis Results — getDiffResults","text":"object BulkRNAseq object name Character. Name differential analysis result extract. NULL, returns results.","code":""},{"path":"https://hui950319.github.io/BulkS4/reference/getDiffResults.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get Differential Analysis Results — getDiffResults","text":"List data.frame differential analysis results","code":""},{"path":"https://hui950319.github.io/BulkS4/reference/getGeneSets.html","id":null,"dir":"Reference","previous_headings":"","what":"Get Gene Sets — getGeneSets","title":"Get Gene Sets — getGeneSets","text":"Extract gene sets BulkRNAseq object","code":""},{"path":"https://hui950319.github.io/BulkS4/reference/getGeneSets.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get Gene Sets — getGeneSets","text":"","code":"getGeneSets(object, name = NULL)"},{"path":"https://hui950319.github.io/BulkS4/reference/getGeneSets.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get Gene Sets — getGeneSets","text":"object BulkRNAseq object name Character. Name gene set extract. NULL, returns gene sets.","code":""},{"path":"https://hui950319.github.io/BulkS4/reference/getGeneSets.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get Gene Sets — getGeneSets","text":"List data.frame gene sets","code":""},{"path":"https://hui950319.github.io/BulkS4/reference/getMetadata.html","id":null,"dir":"Reference","previous_headings":"","what":"Get Metadata — getMetadata","title":"Get Metadata — getMetadata","text":"Extract metadata BulkRNAseq object","code":""},{"path":"https://hui950319.github.io/BulkS4/reference/getMetadata.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get Metadata — getMetadata","text":"","code":"getMetadata(object)"},{"path":"https://hui950319.github.io/BulkS4/reference/getMetadata.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get Metadata — getMetadata","text":"object BulkRNAseq object","code":""},{"path":"https://hui950319.github.io/BulkS4/reference/getMetadata.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get Metadata — getMetadata","text":"Data.frame sample metadata","code":""},{"path":"https://hui950319.github.io/BulkS4/reference/gsea.html","id":null,"dir":"Reference","previous_headings":"","what":"Gene Set Enrichment Analysis (GSEA) for BulkRNAseq Objects — gsea","title":"Gene Set Enrichment Analysis (GSEA) for BulkRNAseq Objects — gsea","text":"Perform Gene Set Enrichment Analysis using clusterProfiler","code":""},{"path":"https://hui950319.github.io/BulkS4/reference/gsea.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Gene Set Enrichment Analysis (GSEA) for BulkRNAseq Objects — gsea","text":"","code":"gsea(   object,   geneSet_name = \"H\",   analysis_name = NULL,   logfc_col = \"logFC\",   geneid_col = \"gene_id\",   pvalueCutoff = 0.05,   pAdjustMethod = \"BH\",   minGSSize = 15,   maxGSSize = 500,   verbose = TRUE )  # S4 method for class 'BulkRNAseq' gsea(   object,   geneSet_name = \"H\",   analysis_name = NULL,   logfc_col = \"logFC\",   geneid_col = \"gene_id\",   pvalueCutoff = 0.05,   pAdjustMethod = \"BH\",   minGSSize = 15,   maxGSSize = 500,   verbose = TRUE )"},{"path":"https://hui950319.github.io/BulkS4/reference/gsea.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Gene Set Enrichment Analysis (GSEA) for BulkRNAseq Objects — gsea","text":"object BulkRNAseq object containing differential expression results geneSet_name Character vector, names gene sets analyze. Default \"H\" (Hallmark) analysis_name Character, name differential analysis results use. NULL, uses first available analysis logfc_col Character, column name log fold change values. Default \"logFC\" geneid_col Character, column name gene identifiers. Default \"gene_id\" pvalueCutoff Numeric, p-value cutoff significance. Default 0.05 pAdjustMethod Character, p-value adjustment method. Default \"BH\" minGSSize Integer, minimum gene set size. Default 15 maxGSSize Integer, maximum gene set size. Default 500 verbose Logical, whether print progress messages. Default TRUE","code":""},{"path":"https://hui950319.github.io/BulkS4/reference/gsea.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Gene Set Enrichment Analysis (GSEA) for BulkRNAseq Objects — gsea","text":"Updated BulkRNAseq object GSEA results stored gsea slot","code":""},{"path":"https://hui950319.github.io/BulkS4/reference/gsea.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Gene Set Enrichment Analysis (GSEA) for BulkRNAseq Objects — gsea","text":"","code":"if (FALSE) { # \\dontrun{ # Basic GSEA analysis bulk_obj <- gsea(bulk_obj, geneSet_name = \"H\")  # Multiple gene sets bulk_obj <- gsea(bulk_obj, geneSet_name = c(\"H\", \"C2_CP_KEGG\"))  # Custom parameters bulk_obj <- gsea(bulk_obj,                   geneSet_name = \"H\",                  pvalueCutoff = 0.01,                  minGSSize = 10) } # }"},{"path":"https://hui950319.github.io/BulkS4/reference/gsva.html","id":null,"dir":"Reference","previous_headings":"","what":"Gene Set Variation Analysis (GSVA) for BulkRNAseq Objects — gsva","title":"Gene Set Variation Analysis (GSVA) for BulkRNAseq Objects — gsva","text":"Perform Gene Set Variation Analysis using GSVA package","code":""},{"path":"https://hui950319.github.io/BulkS4/reference/gsva.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Gene Set Variation Analysis (GSVA) for BulkRNAseq Objects — gsva","text":"","code":"gsva(   object,   geneSet_name = \"H\",   gsva_method = c(\"gsva\", \"ssgsea\"),   kcdf = \"Gaussian\",   min_sz = 1,   max_sz = Inf,   mx_diff = TRUE,   tau = 1,   ssgsea_norm = TRUE,   run_limma = TRUE,   verbose = TRUE )  # S4 method for class 'BulkRNAseq' gsva(   object,   geneSet_name = \"H\",   gsva_method = c(\"gsva\", \"ssgsea\"),   kcdf = \"Gaussian\",   min_sz = 1,   max_sz = Inf,   mx_diff = TRUE,   tau = 1,   ssgsea_norm = TRUE,   run_limma = TRUE,   verbose = TRUE )"},{"path":"https://hui950319.github.io/BulkS4/reference/gsva.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Gene Set Variation Analysis (GSVA) for BulkRNAseq Objects — gsva","text":"object BulkRNAseq object containing expression data geneSet_name Character vector, names gene sets analyze. Default \"H\" (Hallmark) gsva_method Character, GSVA method use. Options: \"gsva\", \"ssgsea\". Default \"gsva\" kcdf Character, kernel use density estimation. Options: \"Gaussian\", \"Poisson\", \"none\". Default \"Gaussian\" min_sz Integer, minimum gene set size. Default 1 max_sz Integer, maximum gene set size. Default Inf mx_diff Logical, whether use max difference. Default TRUE tau Numeric, tau parameter ssGSEA. Default 1 ssgsea_norm Logical, whether normalize ssGSEA scores. Default TRUE run_limma Logical, whether run limma differential analysis. Default TRUE verbose Logical, whether print progress messages. Default TRUE","code":""},{"path":"https://hui950319.github.io/BulkS4/reference/gsva.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Gene Set Variation Analysis (GSVA) for BulkRNAseq Objects — gsva","text":"Updated BulkRNAseq object GSVA results stored gsva slot","code":""},{"path":"https://hui950319.github.io/BulkS4/reference/gsva.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Gene Set Variation Analysis (GSVA) for BulkRNAseq Objects — gsva","text":"","code":"if (FALSE) { # \\dontrun{ # Basic GSVA analysis bulk_obj <- gsva(bulk_obj, geneSet_name = \"H\")  # ssGSEA analysis bulk_obj <- gsva(bulk_obj, geneSet_name = \"H\", gsva_method = \"ssgsea\")  # Multiple gene sets bulk_obj <- gsva(bulk_obj, geneSet_name = c(\"H\", \"C2_CP_KEGG\"))  # Custom parameters bulk_obj <- gsva(bulk_obj,                   geneSet_name = \"H\",                  kcdf = \"Poisson\",                  min_sz = 10,                  max_sz = 200) } # }"},{"path":"https://hui950319.github.io/BulkS4/reference/hmap.html","id":null,"dir":"Reference","previous_headings":"","what":"Heatmap Visualization — hmap","title":"Heatmap Visualization — hmap","text":"Create heatmaps gene expression data BulkRNAseq objects.","code":""},{"path":"https://hui950319.github.io/BulkS4/reference/hmap.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Heatmap Visualization — hmap","text":"","code":"hmap(   object,   data = \"data\",   genes = \"CD36\",   group = \"group\",   show_rownames = TRUE,   scale = \"row\",   color_palette = NULL )  # S4 method for class 'BulkRNAseq' hmap(   object,   data = \"data\",   genes = \"CD36\",   group = \"group\",   show_rownames = TRUE,   scale = \"row\",   color_palette = NULL )"},{"path":"https://hui950319.github.io/BulkS4/reference/hmap.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Heatmap Visualization — hmap","text":"object BulkRNAseq object data Character, data source: \"data\" expression data name gsva result genes Character vector gene names numeric top differential genes group Character, column name metadata annotation show_rownames Logical, whether show gene names scale Character, scaling method (\"row\", \"column\", \"none\") color_palette Color palette heatmap","code":""},{"path":"https://hui950319.github.io/BulkS4/reference/hmap.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Heatmap Visualization — hmap","text":"pheatmap object","code":""},{"path":"https://hui950319.github.io/BulkS4/reference/hmap.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Heatmap Visualization — hmap","text":"","code":"if (FALSE) { # \\dontrun{ hmap(bulk_obj, genes = c(\"CD36\", \"GAPDH\")) hmap(bulk_obj, genes = 10)  # Top 10 differential genes } # }"},{"path":"https://hui950319.github.io/BulkS4/reference/MA.html","id":null,"dir":"Reference","previous_headings":"","what":"MA Plot — MA","title":"MA Plot — MA","text":"Create MA plots differential expression results.","code":""},{"path":"https://hui950319.github.io/BulkS4/reference/MA.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"MA Plot — MA","text":"","code":"MA(   object,   data = \"allDiff\",   fc_threshold = 1,   adj.P_value_threshold = 0.05,   highlight_fc_threshold = 4,   point_size = 1.2,   highlight_size = 3,   colors = c(\"darkred\", \"grey50\", \"royalblue4\", \"green4\") )  # S4 method for class 'BulkRNAseq' MA(   object,   data = \"allDiff\",   fc_threshold = 1,   adj.P_value_threshold = 0.05,   highlight_fc_threshold = 4,   point_size = 1.2,   highlight_size = 3,   colors = c(\"darkred\", \"grey50\", \"royalblue4\", \"green4\") )"},{"path":"https://hui950319.github.io/BulkS4/reference/MA.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"MA Plot — MA","text":"object BulkRNAseq object data Character, name differential analysis result fc_threshold Numeric, fold change threshold adj.P_value_threshold Numeric, adjusted p-value threshold highlight_fc_threshold Numeric, fold change threshold highlighting point_size Numeric, size points highlight_size Numeric, size highlighted points colors Character vector, colors different groups","code":""},{"path":"https://hui950319.github.io/BulkS4/reference/MA.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"MA Plot — MA","text":"ggplot object","code":""},{"path":"https://hui950319.github.io/BulkS4/reference/MA.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"MA Plot — MA","text":"","code":"if (FALSE) { # \\dontrun{ MA(bulk_obj, data = \"allDiff\") } # }"},{"path":"https://hui950319.github.io/BulkS4/reference/pca_hc.html","id":null,"dir":"Reference","previous_headings":"","what":"PCA and Hierarchical Clustering Plot — pca_hc","title":"PCA and Hierarchical Clustering Plot — pca_hc","text":"Create combined PCA hierarchical clustering plots.","code":""},{"path":"https://hui950319.github.io/BulkS4/reference/pca_hc.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"PCA and Hierarchical Clustering Plot — pca_hc","text":"","code":"pca_hc(   object,   dist_method = c(\"euclidean\", \"manhattan\"),   hclust_method = c(\"ward.D2\", \"complete\", \"average\"),   k = 2,   horiz = FALSE,   k_colors = \"lancet\",   rect = TRUE,   rect_fill = TRUE,   pca_style = \"default\",   add_ellipses = TRUE,   repel = TRUE )  # S4 method for class 'BulkRNAseq' pca_hc(   object,   dist_method = c(\"euclidean\", \"manhattan\"),   hclust_method = c(\"ward.D2\", \"complete\", \"average\"),   k = 2,   horiz = FALSE,   k_colors = \"lancet\",   rect = TRUE,   rect_fill = TRUE,   pca_style = \"default\",   add_ellipses = TRUE,   repel = TRUE )"},{"path":"https://hui950319.github.io/BulkS4/reference/pca_hc.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"PCA and Hierarchical Clustering Plot — pca_hc","text":"object BulkRNAseq object dist_method Distance method clustering hclust_method Hierarchical clustering method k Number clusters horiz Logical, horizontal dendrogram k_colors Color palette clusters rect Logical, draw rectangles around clusters rect_fill Logical, fill rectangles pca_style PCA plot style add_ellipses Logical, add confidence ellipses repel Logical, use repel labels","code":""},{"path":"https://hui950319.github.io/BulkS4/reference/pca_hc.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"PCA and Hierarchical Clustering Plot — pca_hc","text":"combined plot object","code":""},{"path":"https://hui950319.github.io/BulkS4/reference/pca_hc.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"PCA and Hierarchical Clustering Plot — pca_hc","text":"","code":"if (FALSE) { # \\dontrun{ pca_hc(bulk_obj) } # }"},{"path":"https://hui950319.github.io/BulkS4/reference/rownames-BulkRNAseq-method.html","id":null,"dir":"Reference","previous_headings":"","what":"Get Row Names — rownames,BulkRNAseq-method","title":"Get Row Names — rownames,BulkRNAseq-method","text":"Get gene names (row names count matrix)","code":""},{"path":"https://hui950319.github.io/BulkS4/reference/rownames-BulkRNAseq-method.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get Row Names — rownames,BulkRNAseq-method","text":"","code":"# S4 method for class 'BulkRNAseq' rownames(x)"},{"path":"https://hui950319.github.io/BulkS4/reference/rownames-BulkRNAseq-method.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get Row Names — rownames,BulkRNAseq-method","text":"x BulkRNAseq object","code":""},{"path":"https://hui950319.github.io/BulkS4/reference/rownames-BulkRNAseq-method.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get Row Names — rownames,BulkRNAseq-method","text":"Character vector gene names","code":""},{"path":"https://hui950319.github.io/BulkS4/reference/runDiffAnalysis.html","id":null,"dir":"Reference","previous_headings":"","what":"Run Differential Expression Analysis on BulkRNAseq Object — runDiffAnalysis","title":"Run Differential Expression Analysis on BulkRNAseq Object — runDiffAnalysis","text":"Perform differential expression analysis BulkRNAseq object using DESeq2, edgeR, limma-voom","code":""},{"path":"https://hui950319.github.io/BulkS4/reference/runDiffAnalysis.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Run Differential Expression Analysis on BulkRNAseq Object — runDiffAnalysis","text":"","code":"runDiffAnalysis(   object,   method = c(\"DESeq2\", \"edgeR\", \"limma_voom\"),   group_col = \"group\",   treat_level = \"treat\",   control_level = \"con\",   fc_cutoff = 1,   padj_cutoff = 0.05,   min_counts = 1,   normalize_method = \"quantile\",   result_name = NULL )"},{"path":"https://hui950319.github.io/BulkS4/reference/runDiffAnalysis.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Run Differential Expression Analysis on BulkRNAseq Object — runDiffAnalysis","text":"object BulkRNAseq object method Character, analysis method: \"DESeq2\", \"edgeR\", \"limma_voom\" group_col Character, column name metadata grouping, default \"group\" treat_level Character, treatment level name, default \"treat\" control_level Character, control level name, default \"con\" fc_cutoff Numeric, log2 fold change threshold, default 1 padj_cutoff Numeric, adjusted p-value threshold, default 0.05 min_counts Numeric, minimum count threshold (DESeq2 ), default 1 normalize_method Character, normalization method (limma-voom ), default \"quantile\" result_name Character, name storing results object, default NULL (auto-generated)","code":""},{"path":"https://hui950319.github.io/BulkS4/reference/runDiffAnalysis.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Run Differential Expression Analysis on BulkRNAseq Object — runDiffAnalysis","text":"Updated BulkRNAseq object analysis results added","code":""},{"path":"https://hui950319.github.io/BulkS4/reference/runDiffAnalysis.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Run Differential Expression Analysis on BulkRNAseq Object — runDiffAnalysis","text":"","code":"if (FALSE) { # \\dontrun{ # Create example object counts_mat <- matrix(rpois(1000, 10), nrow = 100, ncol = 10) rownames(counts_mat) <- paste0(\"Gene\", 1:100) colnames(counts_mat) <- paste0(\"Sample\", 1:10)  metadata <- data.frame(   group = rep(c(\"con\", \"treat\"), each = 5),   row.names = colnames(counts_mat) )  bulk_obj <- BulkRNAseq(counts_mat, metadata)  # Run different analyses bulk_obj <- runDiffAnalysis(bulk_obj, method = \"DESeq2\") bulk_obj <- runDiffAnalysis(bulk_obj, method = \"edgeR\") bulk_obj <- runDiffAnalysis(bulk_obj, method = \"limma_voom\") } # }"},{"path":"https://hui950319.github.io/BulkS4/reference/run_DESeq2.html","id":null,"dir":"Reference","previous_headings":"","what":"Run DESeq2 Differential Expression Analysis — run_DESeq2","title":"Run DESeq2 Differential Expression Analysis — run_DESeq2","text":"Perform differential expression analysis using DESeq2","code":""},{"path":"https://hui950319.github.io/BulkS4/reference/run_DESeq2.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Run DESeq2 Differential Expression Analysis — run_DESeq2","text":"","code":"run_DESeq2(counts, metadata, fc_cutoff = 1, padj_cutoff = 0.05, min_counts = 1)"},{"path":"https://hui950319.github.io/BulkS4/reference/run_DESeq2.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Run DESeq2 Differential Expression Analysis — run_DESeq2","text":"counts Gene expression count matrix (genes x samples) metadata Sample information data frame 'group' column ('treat' 'con') fc_cutoff Log2 fold change threshold filtering, default 1 padj_cutoff Adjusted p-value threshold filtering, default 0.05 min_counts Minimum count threshold filtering low-expression genes, default 1","code":""},{"path":"https://hui950319.github.io/BulkS4/reference/run_DESeq2.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Run DESeq2 Differential Expression Analysis — run_DESeq2","text":"List containing: counts Original count matrix metadata Sample metadata exprSet Normalized expression matrix allDiff genes differential analysis results fltDiff Filtered significant differential genes","code":""},{"path":"https://hui950319.github.io/BulkS4/reference/run_DESeq2.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Run DESeq2 Differential Expression Analysis — run_DESeq2","text":"","code":"if (FALSE) { # \\dontrun{ # Create example data counts <- matrix(rpois(1000, 10), nrow = 100, ncol = 10) rownames(counts) <- paste0(\"Gene\", 1:100) colnames(counts) <- paste0(\"Sample\", 1:10)  metadata <- data.frame(   sample = colnames(counts),   group = rep(c(\"con\", \"treat\"), each = 5) )  # Run DESeq2 analysis result <- run_DESeq2(counts, metadata) } # }"},{"path":"https://hui950319.github.io/BulkS4/reference/run_edgeR.html","id":null,"dir":"Reference","previous_headings":"","what":"Run edgeR Differential Expression Analysis — run_edgeR","title":"Run edgeR Differential Expression Analysis — run_edgeR","text":"Perform differential expression analysis using edgeR","code":""},{"path":"https://hui950319.github.io/BulkS4/reference/run_edgeR.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Run edgeR Differential Expression Analysis — run_edgeR","text":"","code":"run_edgeR(counts, metadata, fc_cutoff = 1, padj_cutoff = 0.05)"},{"path":"https://hui950319.github.io/BulkS4/reference/run_edgeR.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Run edgeR Differential Expression Analysis — run_edgeR","text":"counts Gene expression count matrix (genes x samples) metadata Sample information data frame 'group' column ('treat' 'con') fc_cutoff Log2 fold change threshold filtering, default 1 padj_cutoff Adjusted p-value threshold filtering, default 0.05","code":""},{"path":"https://hui950319.github.io/BulkS4/reference/run_edgeR.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Run edgeR Differential Expression Analysis — run_edgeR","text":"List containing analysis results (structure run_DESeq2)","code":""},{"path":"https://hui950319.github.io/BulkS4/reference/run_edgeR.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Run edgeR Differential Expression Analysis — run_edgeR","text":"","code":"if (FALSE) { # \\dontrun{ result <- run_edgeR(counts, metadata) } # }"},{"path":"https://hui950319.github.io/BulkS4/reference/run_limma_voom.html","id":null,"dir":"Reference","previous_headings":"","what":"Run limma-voom Differential Expression Analysis — run_limma_voom","title":"Run limma-voom Differential Expression Analysis — run_limma_voom","text":"Perform differential expression analysis using limma-voom","code":""},{"path":"https://hui950319.github.io/BulkS4/reference/run_limma_voom.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Run limma-voom Differential Expression Analysis — run_limma_voom","text":"","code":"run_limma_voom(   counts,   metadata,   normalize_method = \"quantile\",   fc_cutoff = 1,   padj_cutoff = 0.05 )"},{"path":"https://hui950319.github.io/BulkS4/reference/run_limma_voom.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Run limma-voom Differential Expression Analysis — run_limma_voom","text":"counts Gene expression count matrix (genes x samples) metadata Sample information data frame 'group' column ('treat' 'con') normalize_method Normalization method voom, default \"quantile\" fc_cutoff Log2 fold change threshold filtering, default 1 padj_cutoff Adjusted p-value threshold filtering, default 0.05","code":""},{"path":"https://hui950319.github.io/BulkS4/reference/run_limma_voom.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Run limma-voom Differential Expression Analysis — run_limma_voom","text":"List containing analysis results (structure run_DESeq2)","code":""},{"path":"https://hui950319.github.io/BulkS4/reference/run_limma_voom.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Run limma-voom Differential Expression Analysis — run_limma_voom","text":"","code":"if (FALSE) { # \\dontrun{ result <- run_limma_voom(counts, metadata) } # }"},{"path":"https://hui950319.github.io/BulkS4/reference/setData.html","id":null,"dir":"Reference","previous_headings":"","what":"Set Normalized Data — setData","title":"Set Normalized Data — setData","text":"Set normalized data matrix BulkRNAseq object","code":""},{"path":"https://hui950319.github.io/BulkS4/reference/setData.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Set Normalized Data — setData","text":"","code":"setData(object, data)"},{"path":"https://hui950319.github.io/BulkS4/reference/setData.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Set Normalized Data — setData","text":"object BulkRNAseq object data Matrix normalized data","code":""},{"path":"https://hui950319.github.io/BulkS4/reference/setData.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Set Normalized Data — setData","text":"Updated BulkRNAseq object","code":""},{"path":"https://hui950319.github.io/BulkS4/reference/show-BulkRNAseq-method.html","id":null,"dir":"Reference","previous_headings":"","what":"Show BulkRNAseq Object — show,BulkRNAseq-method","title":"Show BulkRNAseq Object — show,BulkRNAseq-method","text":"Display method BulkRNAseq objects","code":""},{"path":"https://hui950319.github.io/BulkS4/reference/show-BulkRNAseq-method.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Show BulkRNAseq Object — show,BulkRNAseq-method","text":"","code":"# S4 method for class 'BulkRNAseq' show(object)"},{"path":"https://hui950319.github.io/BulkS4/reference/show-BulkRNAseq-method.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Show BulkRNAseq Object — show,BulkRNAseq-method","text":"object BulkRNAseq object","code":""},{"path":"https://hui950319.github.io/BulkS4/reference/show-BulkRNAseq-method.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Show BulkRNAseq Object — show,BulkRNAseq-method","text":"Invisibly returns object (method chaining)","code":""},{"path":"https://hui950319.github.io/BulkS4/reference/sub-BulkRNAseq-ANY-ANY-ANY-method.html","id":null,"dir":"Reference","previous_headings":"","what":"Subset BulkRNAseq Object — [,BulkRNAseq,ANY,ANY,ANY-method","title":"Subset BulkRNAseq Object — [,BulkRNAseq,ANY,ANY,ANY-method","text":"Subset BulkRNAseq object genes /samples","code":""},{"path":"https://hui950319.github.io/BulkS4/reference/sub-BulkRNAseq-ANY-ANY-ANY-method.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Subset BulkRNAseq Object — [,BulkRNAseq,ANY,ANY,ANY-method","text":"","code":"# S4 method for class 'BulkRNAseq,ANY,ANY,ANY' x[i, j, drop = FALSE]"},{"path":"https://hui950319.github.io/BulkS4/reference/sub-BulkRNAseq-ANY-ANY-ANY-method.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Subset BulkRNAseq Object — [,BulkRNAseq,ANY,ANY,ANY-method","text":"x BulkRNAseq object Row indices (genes) subset j Column indices (samples) subset drop Logical. Whether drop dimensions (used, compatibility)","code":""},{"path":"https://hui950319.github.io/BulkS4/reference/sub-BulkRNAseq-ANY-ANY-ANY-method.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Subset BulkRNAseq Object — [,BulkRNAseq,ANY,ANY,ANY-method","text":"subsetted BulkRNAseq object","code":""},{"path":"https://hui950319.github.io/BulkS4/reference/summary.BulkRNAseq.html","id":null,"dir":"Reference","previous_headings":"","what":"Summary of BulkRNAseq Object — summary.BulkRNAseq","title":"Summary of BulkRNAseq Object — summary.BulkRNAseq","text":"Provide detailed summary BulkRNAseq object contents","code":""},{"path":"https://hui950319.github.io/BulkS4/reference/summary.BulkRNAseq.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summary of BulkRNAseq Object — summary.BulkRNAseq","text":"","code":"# S3 method for class 'BulkRNAseq' summary(object, ...)"},{"path":"https://hui950319.github.io/BulkS4/reference/summary.BulkRNAseq.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Summary of BulkRNAseq Object — summary.BulkRNAseq","text":"object BulkRNAseq object ... Additional arguments (S3 method compatibility)","code":""},{"path":"https://hui950319.github.io/BulkS4/reference/summary.BulkRNAseq.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Summary of BulkRNAseq Object — summary.BulkRNAseq","text":"Invisibly returns list summary information","code":""},{"path":"https://hui950319.github.io/BulkS4/reference/volcano.html","id":null,"dir":"Reference","previous_headings":"","what":"Volcano Plot — volcano","title":"Volcano Plot — volcano","text":"Create volcano plots differential expression results.","code":""},{"path":"https://hui950319.github.io/BulkS4/reference/volcano.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Volcano Plot — volcano","text":"","code":"volcano(   object,   data = \"allDiff\",   fc_threshold = 1,   highlight_fc_threshold = 3,   adj.P_value_threshold = 0.05,   point_size = 1.2,   highlight_size = 3,   colors = c(\"darkred\", \"black\", \"royalblue4\", \"green2\"),   symmetry = FALSE )  # S4 method for class 'BulkRNAseq' volcano(   object,   data = \"allDiff\",   fc_threshold = 1,   highlight_fc_threshold = 3,   adj.P_value_threshold = 0.05,   point_size = 1.2,   highlight_size = 3,   colors = c(\"darkred\", \"black\", \"royalblue4\", \"green2\"),   symmetry = FALSE )"},{"path":"https://hui950319.github.io/BulkS4/reference/volcano.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Volcano Plot — volcano","text":"object BulkRNAseq object data Character, name differential analysis result fc_threshold Numeric, fold change threshold highlight_fc_threshold Numeric, fold change threshold highlighting genes adj.P_value_threshold Numeric, adjusted p-value threshold point_size Numeric, size points highlight_size Numeric, size highlighted points colors Character vector, colors , non-significant, , highlighted genes symmetry Logical, whether make x-axis symmetric","code":""},{"path":"https://hui950319.github.io/BulkS4/reference/volcano.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Volcano Plot — volcano","text":"ggplot object","code":""},{"path":"https://hui950319.github.io/BulkS4/reference/volcano.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Volcano Plot — volcano","text":"","code":"if (FALSE) { # \\dontrun{ volcano(bulk_obj, data = \"allDiff\") } # }"},{"path":[]},{"path":"https://hui950319.github.io/BulkS4/UNICODE_ENCODING_FIX.html","id":"概述","dir":"","previous_headings":"","what":"概述","title":"Unicode编码修复总结","text":"本次修复工作将BulkS4包中所有Unicode编码的中文字符转换为英文，提高代码的国际化兼容性和可读性。","code":""},{"path":[]},{"path":"https://hui950319.github.io/BulkS4/UNICODE_ENCODING_FIX.html","id":"id_1-rmethodsr文件修复","dir":"","previous_headings":"修复内容","what":"1. R/methods.R文件修复","title":"Unicode编码修复总结","text":"修复前的问题： - 错误消息使用Unicode编码的中文字符 - 注释使用Unicode编码的中文字符 - show方法输出使用Unicode编码的中文字符 修复后的改进： - 所有错误消息转换为英文 - 所有注释转换为英文 - show方法输出转换为英文 具体修复：","code":"# 修复前 stop(\"\\u5217\\u540d '\", name, \"' \\u5728metadata\\u4e2d\\u4e0d\\u5b58\\u5728\", call. = FALSE) # 修复后 stop(\"Column '\", name, \"' not found in metadata\", call. = FALSE)  # 修复前 cat(\"\\n\", cli::col_blue(\"====== BulkRNAseq\\u5bf9\\u8c61 ======\"), \"\\n\\n\") # 修复后 cat(\"\\n\", cli::col_blue(\"====== BulkRNAseq Object ======\"), \"\\n\\n\")"},{"path":"https://hui950319.github.io/BulkS4/UNICODE_ENCODING_FIX.html","id":"id_2-rutilsr文件修复","dir":"","previous_headings":"修复内容","what":"2. R/utils.R文件修复","title":"Unicode编码修复总结","text":"修复前的问题： - 错误消息使用中文字符 - 注释使用中文字符 - 函数输出使用中文字符 修复后的改进： - 所有错误消息转换为英文 - 所有注释转换为英文 - summary函数输出转换为英文 具体修复：","code":"# 修复前 stop(\"object必须是BulkRNAseq类型\", call. = FALSE) # 修复后 stop(\"object must be a BulkRNAseq object\", call. = FALSE)  # 修复前 cat(\"BulkRNAseq对象摘要:\\n\") # 修复后 cat(\"BulkRNAseq Object Summary:\\n\")"},{"path":"https://hui950319.github.io/BulkS4/UNICODE_ENCODING_FIX.html","id":"id_3-rs4class_defr文件修复","dir":"","previous_headings":"修复内容","what":"3. R/S4class_def.R文件修复","title":"Unicode编码修复总结","text":"修复前的问题： - 类定义注释使用中文字符 - 错误消息使用中文字符 - 内部注释使用中文字符 修复后的改进： - 所有类定义注释转换为英文 - 所有错误消息转换为英文 - 所有内部注释转换为英文 具体修复：","code":"# 修复前 counts = \"matrix\",           # 原始计数矩阵（基因 x 样本） # 修复后 counts = \"matrix\",           # Raw count matrix (genes x samples)  # 修复前 stop(\"metadata必须为数据框\", call. = FALSE) # 修复后 stop(\"metadata must be a data frame\", call. = FALSE)"},{"path":"https://hui950319.github.io/BulkS4/UNICODE_ENCODING_FIX.html","id":"id_4-rgsvar文件修复","dir":"","previous_headings":"修复内容","what":"4. R/gsva.R文件修复","title":"Unicode编码修复总结","text":"同时修复的GSVA参数问题： - 将mxDiff参数更正为maxDiff，适配GSVA包的新版本","code":""},{"path":[]},{"path":"https://hui950319.github.io/BulkS4/UNICODE_ENCODING_FIX.html","id":"id_1-国际化兼容性提升","dir":"","previous_headings":"修复效果","what":"1. 国际化兼容性提升","title":"Unicode编码修复总结","text":"消除编码问题：移除所有Unicode编码的中文字符 提高可读性：英文错误消息和注释更易理解 标准化：符合R包开发的国际化标准","code":""},{"path":"https://hui950319.github.io/BulkS4/UNICODE_ENCODING_FIX.html","id":"id_2-代码维护性改进","dir":"","previous_headings":"修复效果","what":"2. 代码维护性改进","title":"Unicode编码修复总结","text":"统一语言：整个包使用统一的英文语言 便于调试：英文错误消息便于问题定位 文档一致性：与roxygen2文档保持语言一致","code":""},{"path":"https://hui950319.github.io/BulkS4/UNICODE_ENCODING_FIX.html","id":"id_3-用户体验提升","dir":"","previous_headings":"修复效果","what":"3. 用户体验提升","title":"Unicode编码修复总结","text":"清晰的错误信息：用户能够理解错误消息含义 专业化输出：show方法和summary输出更加专业 国际化支持：支持非中文环境的用户","code":""},{"path":[]},{"path":"https://hui950319.github.io/BulkS4/UNICODE_ENCODING_FIX.html","id":"id_1-unicode编码识别","dir":"","previous_headings":"技术细节","what":"1. Unicode编码识别","title":"Unicode编码修复总结","text":"使用正则表达式\\\\u[0-9a-fA-F]{4}和[\\u4e00-\\u9fff]识别Unicode编码的中文字符。","code":""},{"path":"https://hui950319.github.io/BulkS4/UNICODE_ENCODING_FIX.html","id":"id_2-翻译原则","dir":"","previous_headings":"技术细节","what":"2. 翻译原则","title":"Unicode编码修复总结","text":"准确性：确保翻译准确传达原意 简洁性：使用简洁明了的英文表达 一致性：在整个包中保持术语一致","code":""},{"path":"https://hui950319.github.io/BulkS4/UNICODE_ENCODING_FIX.html","id":"id_3-特殊处理","dir":"","previous_headings":"技术细节","what":"3. 特殊处理","title":"Unicode编码修复总结","text":"错误消息：保持错误消息的信息完整性 技术术语：使用标准的生物信息学英文术语 用户界面：确保用户界面友好","code":""},{"path":[]},{"path":"https://hui950319.github.io/BulkS4/UNICODE_ENCODING_FIX.html","id":"id_1-编码检查","dir":"","previous_headings":"验证和测试","what":"1. 编码检查","title":"Unicode编码修复总结","text":"","code":"# 检查是否还有Unicode编码字符 grep -r \"\\\\u[0-9a-fA-F]{4}\" R/ grep -r \"[\\u4e00-\\u9fff]\" R/"},{"path":"https://hui950319.github.io/BulkS4/UNICODE_ENCODING_FIX.html","id":"id_2-功能测试","dir":"","previous_headings":"验证和测试","what":"2. 功能测试","title":"Unicode编码修复总结","text":"","code":"# 测试所有修复的函数 library(BulkS4) # 测试错误消息 # 测试show方法 # 测试summary方法"},{"path":"https://hui950319.github.io/BulkS4/UNICODE_ENCODING_FIX.html","id":"id_3-包检查","dir":"","previous_headings":"验证和测试","what":"3. 包检查","title":"Unicode编码修复总结","text":"","code":"devtools::check()"},{"path":[]},{"path":"https://hui950319.github.io/BulkS4/UNICODE_ENCODING_FIX.html","id":"id_1-编码规范","dir":"","previous_headings":"未来维护建议","what":"1. 编码规范","title":"Unicode编码修复总结","text":"统一使用英文：新增代码统一使用英文 避免Unicode编码：直接使用英文字符而非Unicode编码 定期检查：定期检查是否有新的编码问题","code":""},{"path":"https://hui950319.github.io/BulkS4/UNICODE_ENCODING_FIX.html","id":"id_2-国际化考虑","dir":"","previous_headings":"未来维护建议","what":"2. 国际化考虑","title":"Unicode编码修复总结","text":"多语言支持：如需支持多语言，使用专门的国际化包 文档一致性：确保代码注释与文档语言一致 用户反馈：收集用户对语言使用的反馈","code":""},{"path":"https://hui950319.github.io/BulkS4/UNICODE_ENCODING_FIX.html","id":"id_3-质量控制","dir":"","previous_headings":"未来维护建议","what":"3. 质量控制","title":"Unicode编码修复总结","text":"代码审查：在代码审查中检查语言使用 自动化检查：在CI/CD中加入编码检查 测试覆盖：确保所有错误消息都有测试覆盖","code":""},{"path":"https://hui950319.github.io/BulkS4/UNICODE_ENCODING_FIX.html","id":"相关文件","dir":"","previous_headings":"","what":"相关文件","title":"Unicode编码修复总结","text":"本次修复涉及的文件： - R/methods.R - S4方法定义 - R/utils.R - 实用函数 - R/S4class_def.R - S4类定义 - R/gsva.R - GSVA分析功能（同时修复参数问题）","code":""},{"path":"https://hui950319.github.io/BulkS4/UNICODE_ENCODING_FIX.html","id":"总结","dir":"","previous_headings":"","what":"总结","title":"Unicode编码修复总结","text":"本次Unicode编码修复工作： 完整性：修复了所有发现的Unicode编码中文字符 一致性：在整个包中使用统一的英文语言 专业性：提升了包的专业化程度和国际化兼容性 可维护性：提高了代码的可维护性和可读性 用户友好：改善了用户体验，特别是错误消息的可理解性 这些改进使BulkS4包更加符合国际化标准，为全球用户提供更好的使用体验。","code":""},{"path":[]},{"path":"https://hui950319.github.io/BulkS4/news/index.html","id":"new-features-0-1-1","dir":"Changelog","previous_headings":"","what":"New Features","title":"BulkS4 0.1.1","text":"Added comprehensive S4 classes bulk RNA-seq data analysis Integrated support differential expression analysis using DESeq2, edgeR, limma-voom Added gene set enrichment analysis (GSEA) functionality Added gene set variation analysis (GSVA) functionality bar(): Gene expression bar/box plots hmap(): Heatmaps clustering volcano(): Volcano plots differential expression MA(): MA plots pca_hc(): PCA hierarchical clustering plots","code":""},{"path":"https://hui950319.github.io/BulkS4/news/index.html","id":"data-management-0-1-1","dir":"Changelog","previous_headings":"","what":"Data Management","title":"BulkS4 0.1.1","text":"BulkRNAseq S4 class unified data storage Automatic MSigDB gene set integration Built-data validation consistency checks Example datasets included: counts, metadata, geneSet_msig","code":""},{"path":"https://hui950319.github.io/BulkS4/news/index.html","id":"documentation-0-1-1","dir":"Changelog","previous_headings":"","what":"Documentation","title":"BulkS4 0.1.1","text":"Complete package documentation roxygen2 Getting Started guide Differential Expression Analysis tutorial Visualization tutorial Professional pkgdown website modern UI","code":""},{"path":"https://hui950319.github.io/BulkS4/news/index.html","id":"bug-fixes-0-1-1","dir":"Changelog","previous_headings":"","what":"Bug Fixes","title":"BulkS4 0.1.1","text":"Fixed LazyData compression warnings Resolved package check issues Improved error handling input validation","code":""},{"path":[]},{"path":"https://hui950319.github.io/BulkS4/news/index.html","id":"initial-release-0-1-0","dir":"Changelog","previous_headings":"","what":"Initial Release","title":"BulkS4 0.1.0","text":"Initial development version Basic S4 class structure Core functionality RNA-seq analysis","code":""}]
