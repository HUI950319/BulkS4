<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Unicode编码修复总结 • BulkS4</title><script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Unicode编码修复总结"><style>
/* Navbar styles */
.navbar-brand, .navbar-nav .nav-link {
  color: #ffffff !important;
}
.navbar-brand:hover, .navbar-nav .nav-link:hover {
  color: #e6f3ff !important;
}
.navbar {
  background-color: #0054AD !important;
}
.navbar-toggler {
  border-color: #ffffff;
}
.navbar-toggler-icon {
  background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'%3e%3cpath stroke='rgba%28255, 255, 255, 0.75%29' stroke-linecap='round' stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/%3e%3c/svg%3e");
}

/* Right sidebar "On this page" section */
aside.col-md-3 nav#toc h2 {
  color: #212529 !important;
  font-weight: 600;
  font-size: 1.1rem;
}

/* TOC navigation links */
aside.col-md-3 nav#toc .nav-link {
  color: #495057 !important;
  font-weight: 400;
  padding: 0.25rem 0;
}

aside.col-md-3 nav#toc .nav-link:hover {
  color: #0054AD !important;
  text-decoration: none;
}

aside.col-md-3 nav#toc .nav-link.active {
  color: #0054AD !important;
  font-weight: 600;
}

/* General sidebar improvements */
aside.col-md-3 {
  background-color: #f8f9fa;
  padding: 1rem;
  border-radius: 0.5rem;
  margin-top: 1rem;
}

/* Main content headings */
h1, h2, h3, h4, h5, h6 {
  color: #212529 !important;
}

/* Links in content */
a {
  color: #0054AD;
}

a:hover {
  color: #003d7a;
}

/* Code blocks */
.sourceCode {
  background-color: #f8f9fa;
  border: 1px solid #e9ecef;
  border-radius: 0.375rem;
}

/* Improve contrast for various elements */
.text-muted {
  color: #6c757d !important;
}

/* Footer */
.footer {
  background-color: #f8f9fa;
  border-top: 1px solid #dee2e6;
}
</style></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">BulkS4</a>

    <small class="nav-text text-default me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.1.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="index.html" aria-label="Home"><span class="fa fa-home"></span></a></li>
<li class="nav-item"><a class="nav-link" href="articles/getting-started.html">Get Started</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-tutorials" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Tutorials</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-tutorials"><li><a class="dropdown-item" href="articles/getting-started.html">Getting Started</a></li>
    <li><a class="dropdown-item" href="articles/differential-analysis.html">Differential Expression Analysis</a></li>
    <li><a class="dropdown-item" href="articles/visualization.html">Visualization</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="news/index.html">News</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="external-link nav-link" href="https://github.com/HUI950319/BulkS4" aria-label="GitHub"><span class="fa fab fa-github"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-title-body">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Unicode编码修复总结</h1>
      <small class="dont-index">Source: <a href="https://github.com/HUI950319/BulkS4/blob/HEAD/UNICODE_ENCODING_FIX.md" class="external-link"><code>UNICODE_ENCODING_FIX.md</code></a></small>
    </div>

<div id="unicode编码修复总结" class="section level1">

<div class="section level2">
<h2 id="概述">概述<a class="anchor" aria-label="anchor" href="#%E6%A6%82%E8%BF%B0"></a></h2>
<p>本次修复工作将BulkS4包中所有Unicode编码的中文字符转换为英文，提高代码的国际化兼容性和可读性。</p>
</div>
<div class="section level2">
<h2 id="修复内容">修复内容<a class="anchor" aria-label="anchor" href="#%E4%BF%AE%E5%A4%8D%E5%86%85%E5%AE%B9"></a></h2>
<div class="section level3">
<h3 id="id_1-rmethodsr文件修复">1. R/methods.R文件修复<a class="anchor" aria-label="anchor" href="#id_1-rmethodsr%E6%96%87%E4%BB%B6%E4%BF%AE%E5%A4%8D"></a></h3>
<p><strong>修复前的问题：</strong> - 错误消息使用Unicode编码的中文字符 - 注释使用Unicode编码的中文字符 - show方法输出使用Unicode编码的中文字符</p>
<p><strong>修复后的改进：</strong> - 所有错误消息转换为英文 - 所有注释转换为英文 - show方法输出转换为英文</p>
<p><strong>具体修复：</strong></p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 修复前</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span><span class="op">(</span><span class="st">"\u5217\u540d '"</span>, <span class="va">name</span>, <span class="st">"' \u5728metadata\u4e2d\u4e0d\u5b58\u5728"</span>, call. <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co"># 修复后</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span><span class="op">(</span><span class="st">"Column '"</span>, <span class="va">name</span>, <span class="st">"' not found in metadata"</span>, call. <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 修复前</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\n"</span>, <span class="fu">cli</span><span class="fu">::</span><span class="fu"><a href="https://cli.r-lib.org/reference/ansi-styles.html" class="external-link">col_blue</a></span><span class="op">(</span><span class="st">"====== BulkRNAseq\u5bf9\u8c61 ======"</span><span class="op">)</span>, <span class="st">"\n\n"</span><span class="op">)</span></span>
<span><span class="co"># 修复后</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\n"</span>, <span class="fu">cli</span><span class="fu">::</span><span class="fu"><a href="https://cli.r-lib.org/reference/ansi-styles.html" class="external-link">col_blue</a></span><span class="op">(</span><span class="st">"====== BulkRNAseq Object ======"</span><span class="op">)</span>, <span class="st">"\n\n"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="id_2-rutilsr文件修复">2. R/utils.R文件修复<a class="anchor" aria-label="anchor" href="#id_2-rutilsr%E6%96%87%E4%BB%B6%E4%BF%AE%E5%A4%8D"></a></h3>
<p><strong>修复前的问题：</strong> - 错误消息使用中文字符 - 注释使用中文字符 - 函数输出使用中文字符</p>
<p><strong>修复后的改进：</strong> - 所有错误消息转换为英文 - 所有注释转换为英文 - summary函数输出转换为英文</p>
<p><strong>具体修复：</strong></p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 修复前</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span><span class="op">(</span><span class="st">"object必须是BulkRNAseq类型"</span>, call. <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co"># 修复后</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span><span class="op">(</span><span class="st">"object must be a BulkRNAseq object"</span>, call. <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 修复前</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"BulkRNAseq对象摘要:\n"</span><span class="op">)</span></span>
<span><span class="co"># 修复后</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"BulkRNAseq Object Summary:\n"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="id_3-rs4class_defr文件修复">3. R/S4class_def.R文件修复<a class="anchor" aria-label="anchor" href="#id_3-rs4class_defr%E6%96%87%E4%BB%B6%E4%BF%AE%E5%A4%8D"></a></h3>
<p><strong>修复前的问题：</strong> - 类定义注释使用中文字符 - 错误消息使用中文字符 - 内部注释使用中文字符</p>
<p><strong>修复后的改进：</strong> - 所有类定义注释转换为英文 - 所有错误消息转换为英文 - 所有内部注释转换为英文</p>
<p><strong>具体修复：</strong></p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="co"># 修复前</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>counts <span class="ot">=</span> <span class="st">"matrix"</span>,           <span class="co"># 原始计数矩阵（基因 x 样本）</span></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a><span class="co"># 修复后</span></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>counts <span class="ot">=</span> <span class="st">"matrix"</span>,           <span class="co"># Raw count matrix (genes x samples)</span></span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a></span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a><span class="co"># 修复前</span></span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a><span class="fu">stop</span>(<span class="st">"metadata必须为数据框"</span>, <span class="at">call. =</span> <span class="cn">FALSE</span>)</span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a><span class="co"># 修复后</span></span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a><span class="fu">stop</span>(<span class="st">"metadata must be a data frame"</span>, <span class="at">call. =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="id_4-rgsvar文件修复">4. R/gsva.R文件修复<a class="anchor" aria-label="anchor" href="#id_4-rgsvar%E6%96%87%E4%BB%B6%E4%BF%AE%E5%A4%8D"></a></h3>
<p><strong>同时修复的GSVA参数问题：</strong> - 将<code>mxDiff</code>参数更正为<code>maxDiff</code>，适配GSVA包的新版本</p>
</div>
</div>
<div class="section level2">
<h2 id="修复效果">修复效果<a class="anchor" aria-label="anchor" href="#%E4%BF%AE%E5%A4%8D%E6%95%88%E6%9E%9C"></a></h2>
<div class="section level3">
<h3 id="id_1-国际化兼容性提升">1. 国际化兼容性提升<a class="anchor" aria-label="anchor" href="#id_1-%E5%9B%BD%E9%99%85%E5%8C%96%E5%85%BC%E5%AE%B9%E6%80%A7%E6%8F%90%E5%8D%87"></a></h3>
<ul><li>
<strong>消除编码问题</strong>：移除所有Unicode编码的中文字符</li>
<li>
<strong>提高可读性</strong>：英文错误消息和注释更易理解</li>
<li>
<strong>标准化</strong>：符合R包开发的国际化标准</li>
</ul></div>
<div class="section level3">
<h3 id="id_2-代码维护性改进">2. 代码维护性改进<a class="anchor" aria-label="anchor" href="#id_2-%E4%BB%A3%E7%A0%81%E7%BB%B4%E6%8A%A4%E6%80%A7%E6%94%B9%E8%BF%9B"></a></h3>
<ul><li>
<strong>统一语言</strong>：整个包使用统一的英文语言</li>
<li>
<strong>便于调试</strong>：英文错误消息便于问题定位</li>
<li>
<strong>文档一致性</strong>：与roxygen2文档保持语言一致</li>
</ul></div>
<div class="section level3">
<h3 id="id_3-用户体验提升">3. 用户体验提升<a class="anchor" aria-label="anchor" href="#id_3-%E7%94%A8%E6%88%B7%E4%BD%93%E9%AA%8C%E6%8F%90%E5%8D%87"></a></h3>
<ul><li>
<strong>清晰的错误信息</strong>：用户能够理解错误消息含义</li>
<li>
<strong>专业化输出</strong>：show方法和summary输出更加专业</li>
<li>
<strong>国际化支持</strong>：支持非中文环境的用户</li>
</ul></div>
</div>
<div class="section level2">
<h2 id="技术细节">技术细节<a class="anchor" aria-label="anchor" href="#%E6%8A%80%E6%9C%AF%E7%BB%86%E8%8A%82"></a></h2>
<div class="section level3">
<h3 id="id_1-unicode编码识别">1. Unicode编码识别<a class="anchor" aria-label="anchor" href="#id_1-unicode%E7%BC%96%E7%A0%81%E8%AF%86%E5%88%AB"></a></h3>
<p>使用正则表达式<code>\\u[0-9a-fA-F]{4}</code>和<code>[\u4e00-\u9fff]</code>识别Unicode编码的中文字符。</p>
</div>
<div class="section level3">
<h3 id="id_2-翻译原则">2. 翻译原则<a class="anchor" aria-label="anchor" href="#id_2-%E7%BF%BB%E8%AF%91%E5%8E%9F%E5%88%99"></a></h3>
<ul><li>
<strong>准确性</strong>：确保翻译准确传达原意</li>
<li>
<strong>简洁性</strong>：使用简洁明了的英文表达</li>
<li>
<strong>一致性</strong>：在整个包中保持术语一致</li>
</ul></div>
<div class="section level3">
<h3 id="id_3-特殊处理">3. 特殊处理<a class="anchor" aria-label="anchor" href="#id_3-%E7%89%B9%E6%AE%8A%E5%A4%84%E7%90%86"></a></h3>
<ul><li>
<strong>错误消息</strong>：保持错误消息的信息完整性</li>
<li>
<strong>技术术语</strong>：使用标准的生物信息学英文术语</li>
<li>
<strong>用户界面</strong>：确保用户界面友好</li>
</ul></div>
</div>
<div class="section level2">
<h2 id="验证和测试">验证和测试<a class="anchor" aria-label="anchor" href="#%E9%AA%8C%E8%AF%81%E5%92%8C%E6%B5%8B%E8%AF%95"></a></h2>
<div class="section level3">
<h3 id="id_1-编码检查">1. 编码检查<a class="anchor" aria-label="anchor" href="#id_1-%E7%BC%96%E7%A0%81%E6%A3%80%E6%9F%A5"></a></h3>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="co"># 检查是否还有Unicode编码字符</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>grep <span class="sc">-</span>r <span class="st">"</span><span class="sc">\\</span><span class="st">u[0-9a-fA-F]{4}"</span> R<span class="sc">/</span></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>grep <span class="sc">-</span>r <span class="st">"[\u4e00-\u9fff]"</span> R<span class="sc">/</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="id_2-功能测试">2. 功能测试<a class="anchor" aria-label="anchor" href="#id_2-%E5%8A%9F%E8%83%BD%E6%B5%8B%E8%AF%95"></a></h3>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 测试所有修复的函数</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://hui950319.github.io/BulkS4/">BulkS4</a></span><span class="op">)</span></span>
<span><span class="co"># 测试错误消息</span></span>
<span><span class="co"># 测试show方法</span></span>
<span><span class="co"># 测试summary方法</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="id_3-包检查">3. 包检查<a class="anchor" aria-label="anchor" href="#id_3-%E5%8C%85%E6%A3%80%E6%9F%A5"></a></h3>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://devtools.r-lib.org/reference/check.html" class="external-link">check</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="未来维护建议">未来维护建议<a class="anchor" aria-label="anchor" href="#%E6%9C%AA%E6%9D%A5%E7%BB%B4%E6%8A%A4%E5%BB%BA%E8%AE%AE"></a></h2>
<div class="section level3">
<h3 id="id_1-编码规范">1. 编码规范<a class="anchor" aria-label="anchor" href="#id_1-%E7%BC%96%E7%A0%81%E8%A7%84%E8%8C%83"></a></h3>
<ul><li>
<strong>统一使用英文</strong>：新增代码统一使用英文</li>
<li>
<strong>避免Unicode编码</strong>：直接使用英文字符而非Unicode编码</li>
<li>
<strong>定期检查</strong>：定期检查是否有新的编码问题</li>
</ul></div>
<div class="section level3">
<h3 id="id_2-国际化考虑">2. 国际化考虑<a class="anchor" aria-label="anchor" href="#id_2-%E5%9B%BD%E9%99%85%E5%8C%96%E8%80%83%E8%99%91"></a></h3>
<ul><li>
<strong>多语言支持</strong>：如需支持多语言，使用专门的国际化包</li>
<li>
<strong>文档一致性</strong>：确保代码注释与文档语言一致</li>
<li>
<strong>用户反馈</strong>：收集用户对语言使用的反馈</li>
</ul></div>
<div class="section level3">
<h3 id="id_3-质量控制">3. 质量控制<a class="anchor" aria-label="anchor" href="#id_3-%E8%B4%A8%E9%87%8F%E6%8E%A7%E5%88%B6"></a></h3>
<ul><li>
<strong>代码审查</strong>：在代码审查中检查语言使用</li>
<li>
<strong>自动化检查</strong>：在CI/CD中加入编码检查</li>
<li>
<strong>测试覆盖</strong>：确保所有错误消息都有测试覆盖</li>
</ul></div>
</div>
<div class="section level2">
<h2 id="相关文件">相关文件<a class="anchor" aria-label="anchor" href="#%E7%9B%B8%E5%85%B3%E6%96%87%E4%BB%B6"></a></h2>
<p>本次修复涉及的文件： - <code>R/methods.R</code> - S4方法定义 - <code>R/utils.R</code> - 实用函数 - <code>R/S4class_def.R</code> - S4类定义 - <code>R/gsva.R</code> - GSVA分析功能（同时修复参数问题）</p>
</div>
<div class="section level2">
<h2 id="总结">总结<a class="anchor" aria-label="anchor" href="#%E6%80%BB%E7%BB%93"></a></h2>
<p>本次Unicode编码修复工作：</p>
<ol style="list-style-type: decimal"><li>
<strong>完整性</strong>：修复了所有发现的Unicode编码中文字符</li>
<li>
<strong>一致性</strong>：在整个包中使用统一的英文语言</li>
<li>
<strong>专业性</strong>：提升了包的专业化程度和国际化兼容性</li>
<li>
<strong>可维护性</strong>：提高了代码的可维护性和可读性</li>
<li>
<strong>用户友好</strong>：改善了用户体验，特别是错误消息的可理解性</li>
</ol><p>这些改进使BulkS4包更加符合国际化标准，为全球用户提供更好的使用体验。</p>
</div>
</div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://github.com/HUI950319" class="external-link">Hui Ouyang</a>. Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

<div class="pkgdown-footer-right">
  <p>BulkS4 v0.1.1</p>
</div>

    </footer></div>





  </body></html>

